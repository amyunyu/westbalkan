import React, { useState, useEffect, useRef } from 'react';
import { 
  MapPin, 
  Sun, 
  Cloud, 
  CloudRain, 
  ArrowLeft, 
  Plane, 
  Info, 
  Calendar, 
  Camera, 
  Coffee, 
  Utensils, 
  History, 
  Map,
  ChevronRight,
  Luggage,
  Hotel,
  Train,
  Ship,
  Clock,
  BookOpen,
  Wallet,
  Plus,
  Trash2,
  Navigation
} from 'lucide-react';

// --- è‰²ç¥¨å®šç¾© (Morandi Palette) ---
// èƒŒæ™¯: æ·ºç±³é»ƒ #FDFCF5
// ä¸»è‰²: è«è˜­è¿ªç¶  #8FA598
// å‰¯è‰²: éœ§éœ¾è— #9DB4C0
// é»ç¶´: ä¹¾ç‡¥ç«ç‘° #C6B3B3
// æ–‡å­—: æ·±ç° #4A4A4A

// --- è³‡æ–™çµæ§‹ ---

const generateDateRange = (startStr, endStr) => {
  const dates = [];
  let curr = new Date(startStr);
  const end = new Date(endStr);
  let dayCount = 1;

  while (curr <= end) {
    dates.push({
      dateObj: new Date(curr),
      dateStr: curr.toISOString().split('T')[0],
      dayNum: dayCount,
      weekday: curr.toLocaleDateString('zh-TW', { weekday: 'short' }),
      displayDate: `${curr.getMonth() + 1}/${curr.getDate()}`
    });
    curr.setDate(curr.getDate() + 1);
    dayCount++;
  }
  return dates;
};

const tripDates = generateDateRange('2025-05-24', '2025-06-13');

// ä¸»è¦åŸå¸‚å°ç…§è¡¨
const cityMap = {
  '2025-05-24': 'å°åŒ—',
  '2025-05-25': 'æœ­æ ¼ç‘å¸ƒ',
  '2025-05-26': 'æœ­æ ¼ç‘å¸ƒ',
  '2025-05-27': 'ç›§æ¯”å®‰ç´',
  '2025-05-28': 'å¸ƒèŠå¾·',
  '2025-05-29': 'å¸ƒèŠå¾·',
  '2025-05-30': 'ç¾…ç¶­å°¼',
  '2025-05-31': 'æ™®æ‹‰',
  '2025-06-01': 'åå…­æ¹–',
  '2025-06-02': 'æœ­é”çˆ¾',
  '2025-06-03': 'æ–¯æ™®åˆ©ç‰¹',
  '2025-06-04': 'èµ«ç“¦çˆ¾',
  '2025-06-05': 'è«æ–¯å¡”çˆ¾',
  '2025-06-06': 'å¡æ‹‰è€¶ä½›',
  '2025-06-07': 'å¡æ‹‰è€¶ä½›',
  '2025-06-08': 'ç§‘æ‰˜çˆ¾',
  '2025-06-09': 'ç§‘æ‰˜çˆ¾',
  '2025-06-10': 'æœå¸ƒç¾…å¤«å°¼å…‹',
  '2025-06-11': 'æœå¸ƒç¾…å¤«å°¼å…‹',
  '2025-06-12': 'è¿”ç¨‹',
  '2025-06-13': 'å°åŒ—'
};

const mockWeather = {
  sunny: { icon: <Sun className="w-5 h-5 text-orange-400" />, temp: "24Â°C" },
  cloudy: { icon: <Cloud className="w-5 h-5 text-gray-400" />, temp: "22Â°C" },
  rainy: { icon: <CloudRain className="w-5 h-5 text-blue-400" />, temp: "19Â°C" },
};

// *** è¡Œç¨‹è³‡æ–™åº« ***
const itineraryDatabase = {
  '2025-05-24': {
    dayTitle: 'å•Ÿç¨‹ï½œé£›å‘å·´çˆ¾å¹¹',
    events: [
      { id: 'flight-tpe-zag', time: '23:05', title: 'å°åŒ— - æœæ‹œ (è½‰æ©Ÿ)', location: 'æ¡ƒåœ’åœ‹éš›æ©Ÿå ´', type: 'flight', notes: 'é˜¿è¯é…‹èˆªç©º EK367', details: { intro: '23:05 TPE å‡ºç™¼ -> 04:40 DXB æŠµé” (è½‰æ©Ÿ)ã€‚' } }
    ]
  },
  '2025-05-25': {
    dayTitle: 'åˆè¦‹ï½œæœ­æ ¼ç‘å¸ƒ',
    events: [
      { id: 'flight-zag-arr', time: '13:30', title: 'æŠµé”æœ­æ ¼ç‘å¸ƒ', location: 'Zagreb Airport', type: 'arrival', notes: 'èˆªç­ EK2012 æŠµé”', details: { intro: 'å¾æœæ‹œè½‰æ©Ÿé£›å¾€æœ­æ ¼ç‘å¸ƒã€‚' } },
      { 
        id: 'car-rental', 
        time: '15:00', 
        title: 'ç§Ÿè»Šå–è»Š', 
        location: 'Zagreb Airport', 
        type: 'transport', 
        notes: 'è¾¦ç†ç§Ÿè»Šæ‰‹çºŒ', 
        details: { intro: 'å–è»Šæ™‚è«‹å‹™å¿…æª¢æŸ¥è»Šèº«å¤–è§€åˆ®ç—•ä¸¦æ‹ç…§ç•™åº•ï¼Œç¢ºèªä¿éšªæ¶µè“‹ç¯„åœã€‚' } 
      },
      { 
        id: 'stay-zagreb', 
        time: '16:00', 
        title: 'ä½å®¿ - æœ­æ ¼é”å¸ƒ', 
        location: 'Zagreb', 
        type: 'hotel', 
        notes: 'Check-in', 
        details: { intro: 'æŠµé”é¦–éƒ½å¸‚å€ï¼Œå®‰é “è¡Œæï¼Œæº–å‚™ç¨ä½œä¼‘æ¯å¾Œå‡ºé–€æ¢ç´¢ã€‚' } 
      },
      { 
        id: 'zagreb-walk-eve', 
        time: '17:00', 
        title: 'èˆŠåŸå€é–’æ™ƒ', 
        location: 'Upper Town Zagreb', 
        type: 'scene', 
        notes: 'ä¸»æ•™åº§å ‚ã€çŸ³é–€ã€è–é¦¬çˆ¾è°·æ•™å ‚', 
        details: { 
            intro: `ã€åˆå¾Œæ¼«æ­¥ã€‘\nè¾¦ç†å…¥ä½å¾Œï¼Œè¶è‘—å‚æ™šå¤©è‰²é‚„äº®ï¼Œå…ˆåˆ°ä¸ŠåŸå€æ„Ÿå—å¤åŸæ°›åœã€‚\n\nã€æ¨è–¦è·¯ç·šã€‘\n1. æœ­æ ¼ç‘å¸ƒä¸»æ•™åº§å ‚ (ZagrebaÄka katedrala)ï¼šé›™å¡”åœ°æ¨™ï¼Œé›–ç„¶å¸¸åœ¨ç¶­ä¿®ä¸­ï¼Œä½†ä¾ç„¶å£¯è§€ã€‚\n2. çŸ³é–€ (Kamenita vrata)ï¼šé€™æ˜¯é€šå¾€ä¸ŠåŸå€å”¯ä¸€åƒ…å­˜çš„ä¸­ä¸–ç´€åŸé–€ã€‚å‚³èªªä¸­ä¸€å ´å¤§ç«ç‡’æ¯€äº†åŸé–€ï¼Œå”¯ç¨è–æ¯ç•«åƒå¥‡è¹Ÿèˆ¬æ¯«é«®ç„¡å‚·ï¼Œå› æ­¤é€™è£¡æˆç‚ºäº†ç•¶åœ°äººçš„ç¥ˆç¦±è–åœ°ï¼Œè·¯éæ™‚å¸¸èƒ½è¦‹åˆ°é»é»ç‡­å…‰ã€‚\n3. è–é¦¬çˆ¾è°·æ•™å ‚ (Crkva sv. Marka)ï¼šå‚æ™šéŠå®¢è¼ƒå°‘ï¼Œå¯ä»¥æ›´æ‚ é–’åœ°æ¬£è³å±‹é ‚ä¸Šå¯æ„›çš„é¦¬è³½å…‹æ‹¼è²¼å¾½ç« ã€‚`
        } 
      }
    ]
  },
  '2025-05-26': {
    dayTitle: 'æ¼«æ­¥ï½œç¶“å…¸æ•£æ­¥è·¯ç·š',
    events: [
      { 
        id: 'zagreb-walk-1', 
        time: '09:00', 
        title: 'æ•£æ­¥èµ·é»ï¼šZrinjevac & Tomislav', 
        location: 'Zrinjevac Park', 
        type: 'scene', 
        notes: 'éå¸¸è¼•é¬†ã€è·¯é¢å¹³å¦çš„æ—©æ™¨æ•£æ­¥', 
        details: { intro: 'ã€è·¯ç·š 1ã€‘\nZrinjevac Park â†’ Art Pavilion â†’ King Tomislav Square\n\nä½ æœƒçœ‹åˆ°ï¼š\nâ— å…¬åœ’ä¸­å¤®å™´æ³‰\nâ— æ¨¹æ—æ­¥é“\nâ— é»ƒè‰²å¤–ç‰†çš„ Art Pavilion\nâ— é è™•éµé“è»Šç«™æ–¹å‘çš„åŸå¸‚é–‹é—Šæ™¯' } 
      },
      { 
        id: 'zagreb-walk-2', 
        time: '10:00', 
        title: 'Ban JelaÄiÄ‡ Square', 
        location: 'Ban JelaÄiÄ‡ Square', 
        type: 'scene', 
        notes: 'å¾€åŒ—ç›´èµ°ï¼ŒZagreb æœ€ç†±é¬§çš„ä¸­å¿ƒ', 
        details: { intro: 'ã€è·¯ç·š 2ã€‘\nKing Tomislav Square â†’ Ban JelaÄiÄ‡ Squareï¼ˆä¸»å»£å ´ï¼‰\n\né€™æ®µè·¯æœ€ç°¡å–®ï¼Œå°±æ˜¯å¾€åŒ—ç›´èµ°å³å¯ã€‚è€¶æ‹‰å¥‘å¥‡å»£å ´æ˜¯ Zagreb æœ€ç†±é¬§çš„ä¸­å¿ƒã€‚' } 
      },
      { 
        id: 'zagreb-market', 
        time: '10:30', 
        title: 'æœµæ‹‰èŒ²å¸‚å ´ Dolac', 
        location: 'Dolac Market', 
        type: 'food', 
        notes: 'èµ°ä¸Šæ¨“æ¢¯ 20 ç§’å³é”ç´…å‚˜å¸‚å ´', 
        details: { 
            intro: `ã€è·¯ç·š 3ã€‘\nBan JelaÄiÄ‡ Square â†’ Dolac Market\n\nâ— å°èˆªï¼šèµ°ä¸Šå³å¾Œæ–¹çš„æ¨“æ¢¯ 20 ç§’å³å¯åˆ°é”ç´…å‚˜å¸‚å ´ï¼Œéå¸¸æ˜é¡¯ã€‚\nâ— å»ºè­°åœç•™ï¼šç´„ 20â€“40 åˆ†é˜ã€‚\n\nã€æ™¯é»ä»‹ç´¹ã€‘\næœµæ‹‰èŒ²å¸‚å ´è‡ª 1930 å¹´é–‹æ¥­ä»¥ä¾†ï¼Œä¸€ç›´æ˜¯æœ­æ ¼ç‘å¸ƒçš„ã€Œè‚šè‡ã€ã€‚\n\nã€å¿…çœ‹äº®é»ã€‘\n1. ç´…è‰²é®é™½å‚˜æµ·ï¼šè±¡å¾µç•¶åœ°çš„å‚³çµ±ã€‚\n2. Kumica Barica éŠ…åƒï¼šç´€å¿µé ­é ‚èœç±ƒçš„è¾²å©¦ã€‚\n3. å®¤å…§å€ï¼šåˆ¥éŒ¯éå®¤å…§çš„é­šå¸‚å ´èˆ‡èµ·å¸å€ã€‚`
        } 
      },
      { 
        id: 'zagreb-funicular', 
        time: '11:30', 
        title: 'Zagreb Funicular', 
        location: 'Zagreb Funicular', 
        type: 'scene', 
        notes: 'å¾€å—ä¸‹å¡ 2-3 åˆ†é˜å³é”ï¼Œä¸–ç•Œæœ€çŸ­çºœè»Š', 
        details: {
            intro: `ã€è·¯ç·š 4ã€‘\nDolac Market â†’ Zagreb Funicular\n\nâ— å°èˆªï¼šå¾å¸‚å ´å¾€å—ä¸‹å¡ 2â€“3 åˆ†é˜å°±åˆ°çºœè»Šå…¥å£ã€‚éå¸¸è¿‘ï¼Œä¸æœƒè¿·è·¯ã€‚\nâ— é«”é©—ï¼šæ­ä¹˜é€™åº§è—è‰²å°çºœè»Šä¸ŠåŸï¼Œåªéœ€ 64 ç§’ã€‚`
        }
      },
      { 
        id: 'zagreb-tower', 
        time: '11:50', 
        title: 'LotrÅ¡Äak Tower', 
        location: 'LotrÅ¡Äak Tower', 
        type: 'history', 
        notes: 'çºœè»Šå‡ºå£æ—ï¼Œæº–å‚™è½ 12:00 æ­£åˆå¤§ç ²', 
        details: {
            intro: `ã€è·¯ç·š 5ã€‘\næ­ Funicular ä¸ŠåŸ â†’ LotrÅ¡Äak Tower\n\nâ— å°èˆªï¼šå¡”å°±åœ¨çºœè»Šå‡ºå£æ— 20 ç§’ï¼Œéå¸¸å¥½æ‰¾ã€‚\nâ— å¿…çœ‹å„€å¼ï¼šå¦‚æœ 12:00 æ­£å¥½åœ¨é™„è¿‘ï¼Œå¯ä»¥è½æ­£åˆå¤§ç ²ï¼ˆå¾ˆå¤§è²ï¼ï¼‰ã€‚\n\nã€æ™¯é»ä»‹ç´¹ã€‘\né€™åº§å»ºæ–¼13ä¸–ç´€çš„é˜²ç¦¦å¡”æ¨“ï¼Œè‡ª1877å¹´ä»¥ä¾†ï¼Œæ¯å¤©ä¸­åˆ 12:00 æ•´éƒ½æœƒç™¼å°„åŠ è¾²ç ²å ±æ™‚ã€‚`
        }
      },
      { 
        id: 'zagreb-museum', 
        time: '13:30', 
        title: 'Museum of Lost Tales', 
        location: 'Ilica 26, Zagreb', 
        type: 'history', 
        notes: 'å¤±è½å‚³èªªåšç‰©é¤¨', 
        details: { intro: 'å……æ»¿å¥‡å¹»æ°›åœçš„æ²‰æµ¸å¼åšç‰©é¤¨ï¼Œå±•ç¤ºå…‹ç¾…åŸƒè¥¿äºçš„æ°‘é–“å‚³èªªèˆ‡ç¥è©±ç”Ÿç‰©ã€‚' } 
      },
      { 
        id: 'trans-ljubljana', 
        time: '16:30', 
        title: 'å‰å¾€ç›§æ¯”å®‰ç´', 
        location: 'Ljubljana', 
        type: 'transport', 
        notes: 'è·¨å¢ƒå‰å¾€æ–¯æ´›ç¶­å°¼äº', 
        details: { intro: 'è»Šç¨‹ç´„ 2.5 å°æ™‚ï¼Œè¨˜å¾—æº–å‚™è­·ç…§ä»¥å‚™é‚Šå¢ƒæª¢æŸ¥ã€‚' } 
      },
      { 
        id: 'stay-ljubljana', 
        time: '19:00', 
        title: 'ä½å®¿ - ç›§æ¯”å®‰ç´', 
        location: 'Ljubljana', 
        type: 'hotel', 
        notes: 'å…¥ä½æ–¯æ´›ç¶­å°¼äºé¦–éƒ½', 
        details: { intro: 'æŠµé”ã€Œé£›é¾ä¹‹åŸã€ç›§æ¯”å®‰ç´ã€‚' } 
      }
    ]
  },
  '2025-05-27': {
    dayTitle: 'æ¢ç´¢ï½œé£›é¾ä¹‹åŸ',
    events: [
      { id: 'ljubljana-square', time: '09:00', title: 'æ™®åˆ—èˆä»å»£å ´', location: 'PreÅ¡eren Square', type: 'scene', notes: 'ç²‰ç´…æ•™å ‚èˆ‡ä¸‰æ©‹', details: { intro: 'ç›§æ¯”å®‰ç´çš„æ ¸å¿ƒï¼Œä»¥è©©äºº PreÅ¡eren å‘½åã€‚å¿…çœ‹ç²‰ç´…è‰²çš„æ–¹æ¿Ÿå„æœƒæ•™å ‚èˆ‡æ™®åˆ—èµ¤å°¼å…‹è¨­è¨ˆçš„ä¸‰æ©‹ã€‚' } },
      { id: 'ljubljana-market', time: '09:30', title: 'ä¸­å¤®å¸‚å ´ & æ•™å ‚', location: 'Ljubljana Cathedral', type: 'history', notes: 'åƒè§€å¸‚å ´èˆ‡éŠ…é–€', details: { intro: 'ã€è–å°¼å„è€ä¸»æ•™åº§å ‚ã€‘å¿…çœ‹å…©æ‰‡éŠ…é–€ï¼šæç¹ªæ–¯æ´›ç¶­å°¼äºåŸºç£æ•™æ­·å²çš„ã€Œæ–¯æ´›ç¶­å°¼äºä¹‹é–€ã€èˆ‡æ­·ä»»ä¸»æ•™é ­åƒçš„ã€Œç›§æ¯”å®‰ç´ä¹‹é–€ã€ã€‚' } },
      { id: 'ljubljana-dragon', time: '10:30', title: 'é¾æ©‹ Zmajski most', location: 'Dragon Bridge', type: 'scene', notes: 'å¿…æ‹é£›é¾åœ°æ¨™', details: { intro: 'å‚³èªªå¸Œè‡˜è‹±é›„å‚‘æ£®åœ¨æ­¤æ“Šæ•—å·¨é¾ã€‚é€™åº§å»ºæ–¼1901å¹´çš„æ©‹æ¨‘ä¸Šæœ‰å››éš»é’éŠ…ç¿¼é¾ï¼Œæ˜¯åŸå¸‚å®ˆè­·è±¡å¾µã€‚' } },
      { id: 'ljubljana-castle', time: '11:30', title: 'ç›§æ¯”å®‰ç´åŸ', location: 'Ljubljana Castle', type: 'history', notes: 'æ­çºœè»Šæˆ–å¾’æ­¥ä¸ŠåŸå ¡', details: { intro: 'æ­ä¹˜ç»ç’ƒçºœè»Šä¸Šå±±ï¼Œä¿¯ç°ç´…ç“¦å±‹é ‚èˆ‡é è™•é˜¿çˆ¾å‘æ–¯å±±ã€‚' } },
      { id: 'ljubljana-plecnik', time: '14:30', title: 'PleÄnik House', location: 'PleÄnik House', type: 'history', notes: 'å»ºç¯‰å¤§å¸«æ•…å±…', details: { intro: 'åƒè§€å»ºç¯‰å¤§å¸« JoÅ¾e PleÄnik çš„æ•…å±…ï¼Œäº†è§£ä»–å¦‚ä½•å¡‘é€ äº†é€™åº§åŸå¸‚çš„æ¨£è²Œã€‚' } },
      { id: 'ljubljana-walk', time: '16:30', title: 'æ²³å²¸æ•£æ­¥', location: 'Cankarjevo nabreÅ¾je', type: 'scene', notes: 'äº«å—æ²³å²¸å’–å•¡èˆ‡æ‚ é–’æ°›åœ', details: { intro: 'å‚æ™šæ™‚åˆ†ï¼Œåœ¨ Ljubljanica æ²³å²¸æ‰¾å®¶å’–å•¡å»³ï¼Œäº«å—æ…¢æ´»æ™‚å…‰ã€‚' } }
    ]
  },
  '2025-05-28': {
    dayTitle: 'ç§»å‹•ï½œå‰å¾€å¸ƒèŠå¾·',
    events: [
      { id: 'move-bled', time: '10:00', title: 'å‰å¾€å¸ƒèŠå¾·', location: 'Bled', type: 'transport', notes: 'ç§»å‹•æ—¥ï¼Œè»Šç¨‹ç´„ 1 å°æ™‚', details: { intro: 'å‰å¾€é˜¿çˆ¾å‘æ–¯å±±è…³ä¸‹çš„åº¦å‡å‹åœ°å¸ƒèŠå¾·æ¹–ã€‚' } },
      { id: 'stay-bled', time: '14:00', title: 'ä½å®¿ - å¸ƒèŠå¾·', location: 'Bled', type: 'hotel', notes: 'Check-in äº«å—æ¹–å…‰å±±è‰²', details: { intro: 'å…¥ä½å¸ƒèŠå¾·æ¹–ç•”ã€‚' } },
      { id: 'bled-relax', time: '15:30', title: 'æ¹–ç•”è‡ªç”±æ´»å‹•', location: 'Lake Bled', type: 'food', notes: 'å¿…åƒå¸ƒèŠå¾·å¥¶æ²¹è›‹ç³•', details: { intro: 'ã€å¿…åƒç¾é£Ÿï¼šKremÅ¡nitaã€‘\næ¨è–¦åˆ°ç™¼æºåœ° Hotel Park çš„ Kavarna Park å’–å•¡å»³ï¼Œå“åšæ­£å®—çš„å¸ƒèŠå¾·å¥¶æ²¹è›‹ç³• (Bled Cream Cake)ï¼Œäº«å—æ¹–æ™¯ä¸‹åˆèŒ¶ã€‚' } }
    ]
  },
  '2025-05-29': {
    dayTitle: 'ä»™å¢ƒï½œå¸ƒèŠå¾·æ¹–',
    events: [
      { id: 'bled-vintgar', time: '08:30', title: 'æ–‡ç‰¹åŠ å³½è°·', location: 'Vintgar Gorge', type: 'scene', notes: 'æ—©æ™¨å…‰ç·šæœ€ç¾' },
      { id: 'bled-castle', time: '11:00', title: 'å¸ƒèŠå¾·åŸå ¡', location: 'Bled Castle', type: 'history', notes: 'æ‡¸å´–ä¸Šä¿¯ç°æ¹–æ™¯' },
      { id: 'bled-island', time: '13:30', title: 'è–æ¯å‡å¤©æ•™å ‚', location: 'Lake Bled Island', type: 'history', notes: 'æ­ä¹˜ Pletna æ‰‹æ–èˆ¹' },
      { id: 'bled-view', time: '17:00', title: 'è§€æ™¯å°', location: 'Ojstrica Viewpoint', type: 'scene', notes: 'æ”å½±æœ€ä½³è§’åº¦' }
    ]
  },
  '2025-05-30': {
    dayTitle: 'å¥‡æ™¯ï½œæº¶æ´èˆ‡åŸå ¡',
    events: [
      { id: 'vogel', time: '08:30', title: 'æ²ƒæ ¼çˆ¾çºœè»Š', location: 'Vogel Ski Center', type: 'scene', notes: 'ç™»é«˜æœ›é ' },
      { id: 'bohinj', time: '10:00', title: 'åšå¸Œå°¼æ¹–', location: 'Lake Bohinj', type: 'scene', notes: 'å¯§éœçš„å†°è•æ¹–' },
      { id: 'postojna', time: '14:00', title: 'æ³¢æ–¯æ‰˜ä¼Šç´æ´', location: 'Postojna Cave', type: 'scene', notes: 'æ­å°ç«è»Šé€²æº¶æ´' },
      { id: 'predjama', time: '16:00', title: 'æ´çªŸåŸå ¡', location: 'Predjama Castle', type: 'history', notes: 'ä¸–ç•Œæœ€å¤§æ´ç©´åŸå ¡' },
      { id: 'stay-rovinj', time: '18:00', title: 'ä½å®¿ - ç¾…ç¶­å°¼', location: 'Rovinj', type: 'hotel', notes: 'Check-in' }
    ]
  },
  '2025-05-31': {
    dayTitle: 'ç©¿è¶Šï½œæ™®æ‹‰ç«¶æŠ€å ´',
    events: [
      { id: 'pula-drive', time: '09:00', title: 'å‰å¾€æ™®æ‹‰', location: 'Pula', type: 'transport', notes: 'è»Šç¨‹ç´„ 40 åˆ†é˜' },
      { id: 'pula-arena', time: '10:00', title: 'æ™®æ‹‰ç«¶æŠ€å ´', location: 'Pula Arena', type: 'history', notes: 'ç¾…é¦¬åœ“å½¢åŠ‡å ´' },
      { id: 'pula-temple', time: '11:30', title: 'å¥§å¤æ–¯éƒ½ç¥å»Ÿ', location: 'Temple of Augustus', type: 'history', notes: 'ç¾…é¦¬å¤è¹Ÿ' },
      { id: 'pula-arch', time: '12:30', title: 'å¡çˆ¾å‰çƒæ–¯å‡±æ—‹é–€', location: 'Arch of the Sergii', type: 'history', notes: 'æ™®æ‹‰å¤åŸé–€' },
      { id: 'rovinj-back', time: '15:00', title: 'è¿”å›ç¾…ç¶­å°¼', location: 'Rovinj', type: 'scene', notes: 'äº«å—å¤•é™½æ™šé¤' }
    ]
  },
  '2025-06-01': {
    dayTitle: 'ç§˜å¢ƒï½œæ°´è»Šæ‘',
    events: [
      { id: 'rovinj-view', time: '11:00', title: 'Panorama å…¨æ™¯', location: 'Rovinj', type: 'scene', notes: 'æ¬£è³æµ·æ¸¯èˆŠåŸ' },
      { id: 'rovinj-church', time: '11:30', title: 'è–å°¤è²ç±³äºæ•™å ‚', location: 'Church of St. Euphemia', type: 'history', notes: 'åœ°æ¨™é˜å¡”' },
      { id: 'drive-rastoke', time: '14:00', title: 'å‰å¾€æ°´è»Šæ‘', location: 'Rastoke', type: 'transport', notes: 'è»Šç¨‹è¼ƒé•·' },
      { id: 'rastoke', time: '18:00', title: 'æ°´è»Šæ‘', location: 'Rastoke', type: 'scene', notes: 'ç€‘å¸ƒèˆ‡å°å±‹' },
      { id: 'stay-plitvice', time: '19:30', title: 'ä½å®¿ - åå…­æ¹–', location: 'Plitvice Lakes', type: 'hotel', notes: 'ä½åœ¨åœ‹å®¶å…¬åœ’æ—' }
    ]
  },
  '2025-06-02': {
    dayTitle: 'çµ•æ™¯ï½œåå…­æ¹–',
    events: [
      { id: 'plitvice-enter', time: '08:00', title: 'åå…­æ¹–åœ‹å®¶å…¬åœ’', location: 'Plitvice Lakes', type: 'scene', notes: 'å…¨æ—¥éŠè¦½' },
      { id: 'move-zadar', time: '16:00', title: 'å‰å¾€æœ­é”çˆ¾', location: 'Zadar', type: 'transport', notes: 'å‰å¾€æµ·å²¸' },
      { id: 'stay-zadar', time: '18:00', title: 'ä½å®¿ - æœ­é”çˆ¾', location: 'Zadar', type: 'hotel', notes: 'Check-in' }
    ]
  },
  '2025-06-03': {
    dayTitle: 'å¤éŸ»ï½œå¤•é™½æµ·é¢¨ç´',
    events: [
      { id: 'zadar-wells', time: '09:00', title: 'äº”äº•å»£å ´', location: 'Five Wells Square', type: 'history', notes: 'å¤åŸå·¡ç¦®' },
      { id: 'zadar-donatus', time: '09:30', title: 'è–å¤šé‚£æ•™å ‚', location: 'Church of St. Donatus', type: 'history', notes: 'åœ“å½¢æ•™å ‚åœ°æ¨™' },
      { id: 'krka-np', time: '11:00', title: 'å…‹çˆ¾å¡åœ‹å®¶å…¬åœ’', location: 'Krka National Park', type: 'scene', notes: 'è‘—åçš„ç€‘å¸ƒ' },
      { id: 'move-split', time: '15:00', title: 'å‰å¾€æ–¯æ™®åˆ©ç‰¹', location: 'Split', type: 'transport', notes: 'å‰å¾€ç¬¬äºŒå¤§åŸ' },
      { id: 'split-palace', time: '16:30', title: 'æˆ´å…‹é‡Œå…ˆçš‡å®®', location: 'Diocletian\'s Palace', type: 'history', notes: 'æ•´åº§èˆŠåŸå°±æ˜¯çš‡å®®' },
      { id: 'split-cath', time: '17:30', title: 'æ–¯æ™®åˆ©ç‰¹ä¸»æ•™åº§å ‚', location: 'Cathedral of Saint Domnius', type: 'history', notes: 'ç™»é ‚çœ‹é¢¨æ™¯' }
    ]
  },
  '2025-06-04': {
    dayTitle: 'é™½å…‰ï½œèµ«ç“¦çˆ¾å³¶',
    events: [
      { id: 'ferry-hvar', time: '09:00', title: 'æ­èˆ¹å‰å¾€èµ«ç“¦çˆ¾', location: 'Hvar', type: 'ship', notes: 'è·³å³¶ä¹‹æ—…' },
      { id: 'hvar-fort', time: '10:30', title: 'èµ«ç“¦çˆ¾å ¡å£˜', location: 'Fortica', type: 'history', notes: 'ä¿¯ç°æ¸¯å£' },
      { id: 'hvar-town', time: '12:00', title: 'èµ«ç“¦çˆ¾åŸé®è§€å…‰', location: 'Hvar Town', type: 'scene', notes: 'è–å²è’‚èŠ¬å»£å ´' },
      { id: 'ferry-back', time: '16:00', title: 'è¿”å›æ–¯æ™®åˆ©ç‰¹', location: 'Split', type: 'ship', notes: 'çµæŸè·³å³¶' }
    ]
  },
  '2025-06-05': {
    dayTitle: 'ç•°åŸŸï½œè«æ–¯å¡”çˆ¾',
    events: [
      { id: 'move-mostar', time: '09:00', title: 'å‰å¾€è«æ–¯å¡”çˆ¾', location: 'Mostar', type: 'transport', notes: 'è·¨å¢ƒå‰å¾€æ³¢èµ«' },
      { id: 'mostar-checkin', time: '12:00', title: 'ä½å®¿ - Mostar', location: 'Mostar', type: 'hotel', notes: 'Check-in' },
      { id: 'mostar-bridge', time: '13:30', title: 'è«æ–¯å¡”çˆ¾å¤æ©‹', location: 'Stari Most', type: 'history', notes: 'çœ‹è·³æ°´è¡¨æ¼”' },
      { id: 'mostar-bazaar', time: '15:00', title: 'èˆŠå¸‚é›†', location: 'Old Bazaar', type: 'scene', notes: 'åœŸè€³å…¶é¢¨æƒ…' }
    ]
  },
  '2025-06-06': {
    dayTitle: 'æ­·å²ï½œå¡æ‹‰è€¶ä½›',
    events: [
      { id: 'move-sarajevo', time: '09:00', title: 'å‰å¾€å¡æ‹‰è€¶ä½›', location: 'Sarajevo', type: 'transport', notes: 'å‰å¾€æ³¢å£«å°¼äºé¦–éƒ½' },
      { id: 'stay-sarajevo', time: '12:30', title: 'ä½å®¿ - å¡æ‹‰è€¶ä½›', location: 'Sarajevo', type: 'hotel', notes: 'å…¥ä½' },
      { id: 'sarajevo-start', time: '14:00', title: 'å¸‚å€åˆæ¢', location: 'Sarajevo', type: 'scene', notes: 'æ±è¥¿æ–‡åŒ–äº¤è' }
    ]
  },
  '2025-06-07': {
    dayTitle: 'å°è¨˜ï½œèˆŠåŸæ¼«æ­¥',
    events: [
      { id: 'sarajevo-old', time: '09:30', title: 'å·´ä»€å¯Ÿçˆ¾å¸Œäºå¸‚é›†', location: 'BaÅ¡ÄarÅ¡ija', type: 'history', notes: 'å¡ç•¢ç†å™´æ³‰' },
      { id: 'sarajevo-bridge', time: '11:00', title: 'æ‹‰ä¸æ©‹', location: 'Latin Bridge', type: 'history', notes: 'ä¸€æ¬¡å¤§æˆ°å°ç«ç·š' },
      { id: 'sarajevo-cable', time: '14:00', title: 'TrebeviÄ‡ çºœè»Š', location: 'TrebeviÄ‡ Cable Car', type: 'scene', notes: 'ä¿¯ç°å…¨æ™¯' }
    ]
  },
  '2025-06-08': {
    dayTitle: 'å³½ç£ï½œç§‘æ‰˜çˆ¾',
    events: [
      { id: 'move-kotor', time: '08:00', title: 'å‰å¾€ç§‘æ‰˜çˆ¾', location: 'Kotor', type: 'transport', notes: 'å‰å¾€è’™ç‰¹å…§å“¥ç¾…' },
      { id: 'stay-kotor', time: '14:00', title: 'ä½å®¿ - ç§‘æ‰˜çˆ¾', location: 'Kotor', type: 'hotel', notes: 'å…¥ä½å³½ç£å¤åŸ' },
      { id: 'kotor-walk', time: '16:00', title: 'å¤åŸæ¼«æ­¥', location: 'Kotor Old Town', type: 'scene', notes: 'è²“å’ªèˆ‡çŸ³æ¿è·¯' }
    ]
  },
  '2025-06-09': {
    dayTitle: 'ç™»é«˜ï½œæœ€ç¾å³½ç£',
    events: [
      { id: 'kotor-hike', time: '08:30', title: 'ç§‘æ‰˜çˆ¾åŸç‰†å¥è¡Œ', location: 'City Walls', type: 'scene', notes: 'æ—©èµ·çˆ¬ç‰†' },
      { id: 'kotor-bay', time: '14:00', title: 'ç§‘æ‰˜çˆ¾ç£å·¡éŠ', location: 'Bay of Kotor', type: 'ship', notes: 'æ­èˆ¹éŠæ¹–' }
    ]
  },
  '2025-06-10': {
    dayTitle: 'æ¬ŠéŠï½œå›è‡¨åŸ',
    events: [
      { id: 'kotor-church', time: '09:30', title: 'ä¿®é“é™¢', location: 'Franciscan Monastery', type: 'history', notes: 'åƒè§€' },
      { id: 'move-dub', time: '11:00', title: 'å‰å¾€æœå¸ƒç¾…å¤«å°¼å…‹', location: 'Dubrovnik', type: 'transport', notes: 'å‰å¾€å›è‡¨åŸ' },
      { id: 'stay-dub', time: '14:00', title: 'ä½å®¿ - æœå¸ƒç¾…å¤«å°¼å…‹', location: 'Dubrovnik', type: 'hotel', notes: 'Check-in' },
      { id: 'dub-cable', time: '16:30', title: 'Srd å±±çºœè»Š', location: 'Mount Srd', type: 'scene', notes: 'çœ‹å¤•é™½' }
    ]
  },
  '2025-06-11': {
    dayTitle: 'æ¼«æ­¥ï½œå›è‡¨åŸå·¡ç¦®',
    events: [
      { id: 'dub-walls', time: '08:30', title: 'åŸç‰†æ¼«æ­¥', location: 'City Walls', type: 'history', notes: 'é¿é–‹æ›æ›¬' },
      { id: 'dub-fort', time: '11:00', title: 'ç¾…ç¶­é‡Œè€¶å¥ˆå…‹è¦å¡', location: 'Lovrijenac', type: 'history', notes: 'ç´…å ¡å–æ™¯åœ°' },
      { id: 'dub-oldtown', time: '12:30', title: 'å²ç‰¹æ‹‰æ•¦å¤§é“', location: 'Stradun', type: 'scene', notes: 'åˆé¤èˆ‡è³¼ç‰©' },
      { id: 'dub-relax', time: '16:00', title: 'Banje Beach', location: 'Banje Beach', type: 'scene', notes: 'æµ·ç˜æ”¾é¬†' }
    ]
  },
  '2025-06-12': {
    dayTitle: 'å‘Šåˆ¥ï½œå‰å¾€æ©Ÿå ´',
    events: [
      { id: 'flight-checkin', time: 'Check-out', title: 'é€€æˆ¿å‰å¾€æ©Ÿå ´', location: 'Dubrovnik Airport', type: 'transport', notes: 'è¾¦ç†é€€ç¨…' },
      { id: 'flight-back', time: '15:20', title: 'èˆªç­è¿”ç¨‹', location: 'Dubrovnik Airport', type: 'flight', notes: 'EK2075 (flydubai)', details: { intro: 'é£›å¾€æœæ‹œè½‰æ©Ÿã€‚' } }
    ]
  },
  '2025-06-13': {
    dayTitle: 'æ­¸é€”ï½œç”œèœœå®¶åœ’',
    events: [
      { id: 'home', time: 'Arrival', title: 'æŠµé”å°ç£', location: 'TPE Airport', type: 'home', notes: 'EK366 æŠµé”', details: { intro: 'å¹³å®‰æŠµé”æº«æš–çš„å®¶ã€‚' } }
    ]
  }
};

// --- å…ƒä»¶å€ ---

const WeatherWidget = ({ dayIndex }) => {
  const weatherTypes = ['sunny', 'cloudy', 'sunny', 'rainy', 'sunny', 'cloudy', 'sunny'];
  const type = weatherTypes[dayIndex % weatherTypes.length];
  const info = mockWeather[type];

  return (
    <div className="flex items-center gap-2 bg-white/70 backdrop-blur-md rounded-full px-3 py-1.5 shadow-sm border border-[#8FA598]/20 flex-shrink-0">
      <span className="text-sm font-bold text-[#6B7280] tracking-tight">{info.temp}</span>
      <div className="opacity-90">
          {info.icon}
      </div>
    </div>
  );
};

// --- è©³ç´°é é¢å…ƒä»¶ ---
const DetailView = ({ event, onBack }) => {
  if (!event) return null;

  return (
    <div className="fixed inset-0 z-50 bg-[#FDFCF5] overflow-y-auto animate-fade-in-up pb-20">
      
      {/* ç°¡ç´„é ‚éƒ¨å°èˆªåˆ— */}
      <div className="sticky top-0 z-20 flex items-center justify-between px-4 py-3 bg-[#FDFCF5]/95 backdrop-blur-sm border-b border-gray-100/50 shadow-sm">
        <button 
          onClick={onBack}
          className="p-2 bg-white rounded-full shadow-sm border border-gray-100 active:scale-95 transition-transform text-gray-600"
        >
          <ArrowLeft size={20} />
        </button>
        
        {/* æ¨™é¡Œç½®ä¸­ */}
        <h2 className="flex-1 text-center text-lg font-serif font-bold text-[#4A4A4A] px-2 truncate leading-tight">
          {event.title}
        </h2>
        
        {/* ä½”ä½ç¬¦ */}
        <div className="w-9"></div>
      </div>

      <div className="p-6 space-y-6 pt-6">
        
        {/* è¡Œç¨‹è³‡è¨Š (æ™‚é–“ã€åœ°é») */}
        <div className="flex justify-center gap-4 items-center text-sm text-gray-600">
          <div className="flex items-center gap-1 bg-[#E8E0D5] px-3 py-1 rounded-full text-[#4A4A4A] font-bold">
            <Clock size={14} />
            <span>{event.time}</span>
          </div>
          <div className="flex items-center gap-1">
            <MapPin size={14} />
            <span>{event.location}</span>
          </div>
        </div>

        {/* æ–‡å­—å…§å®¹ - æ”¯æ´æ›è¡Œ */}
        <div className="prose prose-stone mx-auto">
          <p className="text-gray-600 leading-relaxed text-justify whitespace-pre-line">
            {event.details?.intro ? event.details.intro : event.notes}
          </p>
        </div>

      </div>
    </div>
  );
};

// --- è¨˜å¸³å°å·¥å…· ---
const ExpenseTracker = () => {
  const [expenses, setExpenses] = useState([
    { id: 1, title: 'æ©Ÿå ´å’–å•¡', amount: 150 },
    { id: 2, title: 'ç¶²å¡ (eSIM)', amount: 500 },
  ]);
  const [inputTitle, setInputTitle] = useState('');
  const [inputAmount, setInputAmount] = useState('');

  const handleAddExpense = () => {
    if (!inputTitle || !inputAmount) return;
    const newExpense = {
      id: Date.now(),
      title: inputTitle,
      amount: Number(inputAmount)
    };
    setExpenses([...expenses, newExpense]);
    setInputTitle('');
    setInputAmount('');
  };

  const handleDeleteExpense = (id) => {
    setExpenses(expenses.filter(item => item.id !== id));
  };

  const totalAmount = expenses.reduce((sum, item) => sum + item.amount, 0);

  return (
    <div className="bg-white p-6 rounded-2xl shadow-sm border border-[#E8E0D5]">
      <h3 className="font-serif text-xl text-[#4A4A4A] mb-4 flex items-center gap-2">
        <Wallet className="text-[#8FA598]" /> æ—…è²»è¨˜å¸³æœ¬
      </h3>
      
      {/* ç¸½é‡‘é¡é¡¯ç¤º */}
      <div className="bg-[#FDFCF5] p-4 rounded-xl mb-4 flex justify-between items-center border border-[#E8E0D5]">
        <span className="text-sm text-gray-500 font-bold">ç›®å‰ç¸½èŠ±è²»</span>
        <span className="text-2xl font-bold text-[#8FA598]">NT$ {totalAmount.toLocaleString()}</span>
      </div>

      {/* è¨˜å¸³åˆ—è¡¨ */}
      <div className="space-y-2 mb-4 max-h-40 overflow-y-auto pr-1">
        {expenses.length > 0 ? (
          expenses.map(item => (
            <div key={item.id} className="flex justify-between items-center text-sm border-b border-gray-50 pb-2 last:border-0">
              <span className="text-gray-700">{item.title}</span>
              <div className="flex items-center gap-3">
                <span className="font-mono text-gray-500 font-medium">${item.amount}</span>
                <button onClick={() => handleDeleteExpense(item.id)} className="text-gray-300 hover:text-red-400">
                  <Trash2 size={14} />
                </button>
              </div>
            </div>
          ))
        ) : (
          <p className="text-center text-xs text-gray-400 py-2">å°šæœªæ–°å¢ä»»ä½•èŠ±è²»</p>
        )}
      </div>

      {/* æ–°å¢è¼¸å…¥æ¡† */}
      <div className="flex gap-2">
        <input 
          type="text" 
          placeholder="é …ç›®" 
          value={inputTitle}
          onChange={(e) => setInputTitle(e.target.value)}
          className="w-full bg-gray-50 border border-gray-100 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-[#8FA598]"
        />
        <input 
          type="number" 
          placeholder="$" 
          value={inputAmount}
          onChange={(e) => setInputAmount(e.target.value)}
          className="w-20 bg-gray-50 border border-gray-100 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-[#8FA598]"
        />
        <button 
          onClick={handleAddExpense}
          className="bg-[#8FA598] text-white rounded-lg px-3 flex items-center justify-center hover:bg-[#7D9386] transition-colors"
        >
          <Plus size={18} />
        </button>
      </div>
    </div>
  );
};

// åœ–ç¤ºé‚è¼¯
const TypeIcon = ({ type }) => {
    const className = "w-5 h-5 text-white";
    let bgClass = "bg-[#8FA598]"; // Default Green
    let icon = <MapPin className={className} />;
  
    switch(type) {
      case 'flight': 
        bgClass = "bg-[#9DB4C0]"; // Blue
        icon = <Plane className={className} />;
        break;
      case 'food':
        bgClass = "bg-[#C6B3B3]"; // Rose
        icon = <Utensils className={className} />;
        break;
      case 'history':
        bgClass = "bg-[#B5A89E]"; // Brownish
        icon = <History className={className} />;
        break;
      case 'scene':
        bgClass = "bg-[#8FA598]"; // Green
        icon = <Camera className={className} />;
        break;
      case 'home':
        bgClass = "bg-[#4A4A4A]"; // Dark
        icon = <Luggage className={className} />;
        break;
      case 'hotel':
        bgClass = "bg-[#D4A373]"; // Wood/Brown
        icon = <Hotel className={className} />;
        break;
      case 'transport':
        bgClass = "bg-[#6B705C]"; // Olive
        icon = <Train className={className} />;
        break;
      case 'ship':
        bgClass = "bg-[#457B9D]"; // Deep Blue
        icon = <Ship className={className} />;
        break;
      case 'arrival':
        bgClass = "bg-[#4A4A4A]";
        icon = <Plane className={className} />;
        break;
    }
  
    return (
      <div className={`${bgClass} w-10 h-10 rounded-full flex items-center justify-center shadow-sm shrink-0`}>
        {icon}
      </div>
    );
  };

// ä¸»é é¢ - æ—…éŠè³‡è¨Šé 
const InfoPage = () => {
  return (
    <div className="p-6 space-y-8 animate-fade-in pb-24">
      
      {/* è¨˜å¸³æ¨¡çµ„ */}
      <ExpenseTracker />

      <div className="bg-white p-6 rounded-2xl shadow-sm border border-[#E8E0D5]">
        <h3 className="font-serif text-xl text-[#4A4A4A] mb-4 flex items-center gap-2">
          <Plane className="text-[#9DB4C0]" /> èˆªç­è³‡è¨Š (é˜¿è¯é…‹èˆªç©º)
        </h3>
        <div className="space-y-4">
          <div className="border-l-2 border-[#9DB4C0] pl-4">
            <p className="text-xs text-gray-500">å»ç¨‹ 5/24</p>
            <p className="font-bold text-gray-800">TPE (23:05) - DXB</p>
            <p className="text-sm text-gray-600">EK367</p>
          </div>
          <div className="border-l-2 border-[#9DB4C0] pl-4">
            <p className="text-xs text-gray-500">å»ç¨‹è½‰æ©Ÿ 5/25</p>
            <p className="font-bold text-gray-800">DXB - ZAG (13:30 æŠµé”)</p>
            <p className="text-sm text-gray-600">EK2012 (flydubai)</p>
          </div>
          <hr className="border-dashed border-gray-200" />
          <div className="border-l-2 border-[#8FA598] pl-4">
            <p className="text-xs text-gray-500">å›ç¨‹ 6/12</p>
            <p className="font-bold text-gray-800">DBV - DXB</p>
            <p className="text-sm text-gray-600">EK2075 (flydubai)</p>
          </div>
          <div className="border-l-2 border-[#8FA598] pl-4">
            <p className="text-xs text-gray-500">å›ç¨‹è½‰æ©Ÿ 6/13</p>
            <p className="font-bold text-gray-800">DXB - TPE</p>
            <p className="text-sm text-gray-600">EK366</p>
          </div>
        </div>
      </div>
      
       <div className="bg-white p-6 rounded-2xl shadow-sm border border-[#E8E0D5]">
        <h3 className="font-serif text-xl text-[#4A4A4A] mb-4 flex items-center gap-2">
            <Hotel className="text-[#D4A373]" /> ä½å®¿æ¦‚è¦½
        </h3>
        <ul className="text-sm text-gray-600 space-y-3 list-none pl-1">
            <li>
                <span className="font-bold text-[#4A4A4A]">å…‹ç¾…åŸƒè¥¿äº</span>
                <ul className="pl-3 border-l-2 border-gray-200 mt-1 space-y-1 text-gray-500">
                    <li>ğŸ“ æœ­æ ¼ç‘å¸ƒ - 1æ™š (5/25-5/26)</li>
                    <li>ğŸ“ ç¾…ç¶­å°¼ - 2æ™š (5/30-6/01)</li>
                    <li>ğŸ“ åå…­æ¹– - 1æ™š (6/01-6/02)</li>
                    <li>ğŸ“ æœ­é”çˆ¾ - 1æ™š (6/02-6/03)</li>
                    <li>ğŸ“ æ–¯æ™®åˆ©ç‰¹ - 2æ™š (6/03-6/05)</li>
                    <li>ğŸ“ æœå¸ƒç¾…å¤«å°¼å…‹ - 2æ™š (6/10-6/12)</li>
                </ul>
            </li>
            <li>
                <span className="font-bold text-[#4A4A4A]">æ–¯æ´›ç¶­å°¼äº</span>
                <ul className="pl-3 border-l-2 border-gray-200 mt-1 space-y-1 text-gray-500">
                    <li>ğŸ“ ç›§æ¯”å®‰ç´ - 2æ™š (5/26-5/28)</li>
                    <li>ğŸ“ å¸ƒèŠå¾· - 2æ™š (5/28-5/30)</li>
                </ul>
            </li>
            <li>
                <span className="font-bold text-[#4A4A4A]">æ³¢èµ« (æ³¢å£«å°¼äºèˆ‡èµ«å¡å“¥ç¶­ç´)</span>
                <ul className="pl-3 border-l-2 border-gray-200 mt-1 space-y-1 text-gray-500">
                    <li>ğŸ“ Mostar - 1æ™š (6/05-6/06)</li>
                    <li>ğŸ“ å¡æ‹‰è€¶ä½› - 2æ™š (6/06-6/08)</li>
                </ul>
            </li>
            <li>
                <span className="font-bold text-[#4A4A4A]">è’™ç‰¹å…§å“¥ç¾… (é»‘å±±)</span>
                <ul className="pl-3 border-l-2 border-gray-200 mt-1 space-y-1 text-gray-500">
                    <li>ğŸ“ ç§‘æ‰˜çˆ¾ - 2æ™š (6/08-6/10)</li>
                </ul>
            </li>
        </ul>
      </div>
    </div>
  );
};

export default function App() {
  const [selectedDateStr, setSelectedDateStr] = useState('2025-05-24');
  const [activeTab, setActiveTab] = useState('itinerary'); 
  const [selectedEvent, setSelectedEvent] = useState(null);
  
  const dateScrollRef = useRef(null);
  const dayData = itineraryDatabase[selectedDateStr] || {};
  const currentEvents = dayData.events || [];
  const currentDayTitle = dayData.dayTitle || 'Enjoy your trip!';
  const currentDayIndex = tripDates.findIndex(d => d.dateStr === selectedDateStr);
  
  const handleEventClick = (event) => setSelectedEvent(event);
  const handleBack = () => setSelectedEvent(null);

  return (
    <div className="w-full max-w-md mx-auto h-screen bg-[#FDFCF5] flex flex-col font-sans text-[#4A4A4A] overflow-hidden relative shadow-2xl">
      <header className="pt-8 pb-2 px-6 bg-[#FDFCF5] z-10">
        <div className="flex justify-between items-end mb-1">
          <div>
            <h1 className="text-2xl font-serif font-bold text-[#4A4A4A]">è¥¿å·´çˆ¾å¹¹åŠå³¶</h1>
            <p className="text-sm text-[#8FA598] tracking-widest uppercase">My Journey</p>
          </div>
        </div>
      </header>

      <div className="flex-1 overflow-hidden relative pb-[80px]"> 
        {activeTab === 'itinerary' && (
            <>
                <div className="mb-2 w-full">
                    <div 
                        ref={dateScrollRef}
                        className="flex overflow-x-auto w-full scrollbar-hide snap-x"
                        style={{ scrollbarWidth: 'none', msOverflowStyle: 'none' }}
                    >
                        {tripDates.map((item, index) => {
                            const isSelected = item.dateStr === selectedDateStr;
                            const cityName = cityMap[item.dateStr] || '';
                            
                            return (
                                <button
                                    key={item.dateStr}
                                    onClick={() => setSelectedDateStr(item.dateStr)}
                                    className={`flex-shrink-0 snap-center min-w-[4.5rem] h-16 flex flex-col items-center justify-center transition-all duration-300 border-r border-b border-t border-gray-200 relative overflow-hidden ${
                                        isSelected 
                                            ? 'bg-[#4A4A4A] text-white border-[#4A4A4A] z-10' 
                                            : 'bg-white text-gray-400 border-gray-100 hover:bg-gray-50'
                                    }`}
                                >
                                    <div className="flex flex-col items-center justify-center h-full w-full pb-3">
                                        <span className="text-[10px] font-medium leading-tight">Day {item.dayNum}</span>
                                        <span className={`text-base font-bold leading-tight ${isSelected ? 'text-[#FDFCF5]' : 'text-gray-700'}`}>
                                            {item.displayDate}
                                        </span>
                                    </div>
                                    
                                    <div className={`absolute bottom-0 left-0 right-0 w-full text-center py-0.5 text-[9px] font-medium truncate px-1 ${
                                        isSelected ? 'bg-[#8FA598] text-white' : 'bg-gray-100 text-gray-500'
                                    }`}>
                                        {cityName}
                                    </div>
                                </button>
                            );
                        })}
                    </div>
                </div>

                <div className="flex-1 overflow-y-auto px-6 h-full pb-6">
                    <div className="flex justify-between items-center mb-4 px-1 sticky top-0 bg-[#FDFCF5] z-10 py-2">
                      <h2 className="font-serif font-bold text-lg text-[#4A4A4A] leading-tight flex-1 mr-2">
                        {currentDayTitle}
                      </h2>
                      <WeatherWidget dayIndex={currentDayIndex} />
                    </div>

                    <div className="space-y-4">
                        {currentEvents.length > 0 ? (
                            currentEvents.map((event, index) => (
                                <div 
                                    key={event.id}
                                    onClick={() => handleEventClick(event)}
                                    className="group bg-white rounded-2xl p-4 shadow-sm border border-gray-50 flex gap-4 items-center active:scale-[0.98] transition-all cursor-pointer relative overflow-hidden"
                                >
                                    <div className={`absolute left-0 top-0 bottom-0 w-1 ${
                                        index % 2 === 0 ? 'bg-[#8FA598]' : 'bg-[#C6B3B3]'
                                    }`}></div>

                                    <div className="flex flex-col items-center gap-2 mr-2 min-w-[3rem]">
                                        <TypeIcon type={event.type} />
                                        <span className="text-[10px] font-bold text-[#8FA598] font-mono text-center leading-tight">
                                            {event.time}
                                        </span>
                                    </div>
                                    
                                    <div className="flex-1 min-w-0 pr-2">
                                        <div className="flex justify-between items-start mb-1">
                                            <h3 className="font-bold text-gray-800 truncate pr-2">{event.title}</h3>
                                        </div>
                                        
                                        <p className="text-sm text-gray-500 line-clamp-2 leading-relaxed">
                                            {event.notes}
                                        </p>
                                    </div>
                                    
                                    {/* å³å´åœ°åœ–æŒ‰éˆ• - æ”¹ç‚º MapPin åœ–ç¤º */}
                                    <button
                                      onClick={(e) => {
                                        e.stopPropagation();
                                        const query = event.location === 'To Ljubljana' ? 'Ljubljana Station' : event.location;
                                        window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`, '_blank');
                                      }}
                                      className="p-3 text-gray-400 hover:text-[#8FA598] hover:bg-gray-100 rounded-full transition-all z-10 shrink-0"
                                      aria-label="åœ¨ Google Maps é–‹å•Ÿ"
                                    >
                                      <MapPin size={20} />
                                    </button>
                                </div>
                            ))
                        ) : (
                            <div className="text-center py-20 text-gray-400">
                                <Coffee className="w-12 h-12 mx-auto mb-4 text-[#E8E0D5]" />
                                <p>æœ¬æ—¥ç„¡ç‰¹å®šè¡Œç¨‹ï¼Œ<br/>äº«å—è‡ªç”±çš„æ¼«æ­¥æ™‚å…‰å§ï¼</p>
                            </div>
                        )}
                    </div>
                </div>
            </>
        )}

        {activeTab === 'info' && (
            <div className="h-full overflow-y-auto pb-6">
                <InfoPage />
            </div>
        )}
      </div>
      
      {/* åº•éƒ¨å°èˆªåˆ— (Bottom Navigation Bar) */}
      <div className="absolute bottom-0 w-full bg-white border-t border-gray-200 shadow-[0_-5px_15px_rgba(0,0,0,0.05)] z-20 flex justify-around items-center safe-area-pb">
        <button 
            onClick={() => setActiveTab('itinerary')}
            className={`flex-1 py-3 flex flex-col items-center gap-1 transition-all active:scale-95 ${activeTab === 'itinerary' ? 'text-[#8FA598]' : 'text-gray-400'}`}
        >
            <Calendar size={24} strokeWidth={activeTab === 'itinerary' ? 2.5 : 2} />
            <span className="text-[10px] font-bold">æ¯æ—¥è¡Œç¨‹</span>
        </button>
        
        <div className="w-px h-8 bg-gray-100"></div>

        <button 
            onClick={() => setActiveTab('info')}
            className={`flex-1 py-3 flex flex-col items-center gap-1 transition-all active:scale-95 ${activeTab === 'info' ? 'text-[#9DB4C0]' : 'text-gray-400'}`}
        >
            <BookOpen size={24} strokeWidth={activeTab === 'info' ? 2.5 : 2} />
            <span className="text-[10px] font-bold">æ—…éŠè³‡è¨Š</span>
        </button>
      </div>

      {selectedEvent && (
        <DetailView event={selectedEvent} onBack={handleBack} />
      )}
      
      <style>{`
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
          animation: fade-in-up 0.3s ease-out forwards;
        }
        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .animate-fade-in {
            animation: fade-in 0.3s ease-out forwards;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .safe-area-pb {
            padding-bottom: env(safe-area-inset-bottom, 10px);
        }
      `}</style>
    </div>
  );
}
