<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>西巴爾幹之旅 App</title>
    
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 引入 React 和 ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- 引入 Babel (用於解析 JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #FDFCF8;
        }
        .font-serif {
            font-family: 'Noto Serif TC', serif;
        }
        /* Custom Scrollbar */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        /* Animation */
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.3s ease-out forwards;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, Fragment } = React;

        // --- Icon Component System ---
        const Icon = ({ name, size = 24, className = "" }) => {
            const icons = {
                MapPin: (
                    <Fragment>
                        <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/>
                        <circle cx="12" cy="10" r="3"/>
                    </Fragment>
                ),
                Calendar: (
                    <Fragment>
                        <rect width="18" height="18" x="3" y="4" rx="2" ry="2"/>
                        <line x1="16" x2="16" y1="2" y2="6"/>
                        <line x1="8" x2="8" y1="2" y2="6"/>
                        <line x1="3" x2="21" y1="10" y2="10"/>
                    </Fragment>
                ),
                Clock: (
                    <Fragment>
                        <circle cx="12" cy="12" r="10"/>
                        <polyline points="12 6 12 12 16 14"/>
                    </Fragment>
                ),
                ChevronLeft: <path d="m15 18-6-6 6-6"/>,
                Plane: (
                    <Fragment>
                        <path d="M2 12h5"/>
                        <path d="M13 5.74V3a2 2 0 0 0-3.56-1.47l-1.56 2.08"/>
                        <path d="M16 12h6"/>
                        <path d="M13 18.26V21a2 2 0 0 1-3.56 1.47l-1.56-2.08"/>
                        <path d="M20 14h2a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2h-2"/>
                        <path d="M7 17a2 2 0 0 0 1.5-3.5L16 6l4 4-7.5 7.5A2 2 0 0 0 7 17Z"/>
                    </Fragment>
                ),
                Car: (
                    <Fragment>
                        <path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/>
                        <circle cx="7" cy="17" r="2"/>
                        <path d="M9 17h6"/>
                        <circle cx="17" cy="17" r="2"/>
                    </Fragment>
                ),
                Info: (
                    <Fragment>
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4"/>
                        <path d="M12 8h.01"/>
                    </Fragment>
                ),
                Sun: (
                    <Fragment>
                        <circle cx="12" cy="12" r="4"/>
                        <path d="M12 2v2"/>
                        <path d="M12 20v2"/>
                        <path d="m4.93 4.93 1.41 1.41"/>
                        <path d="m17.66 17.66 1.41 1.41"/>
                        <path d="M2 12h2"/>
                        <path d="M20 12h2"/>
                        <path d="m6.34 17.66-1.41 1.41"/>
                        <path d="m19.07 4.93-1.41 1.41"/>
                    </Fragment>
                ),
                CloudRain: (
                    <Fragment>
                        <path d="M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242"/>
                        <path d="M16 14v6"/>
                        <path d="M8 14v6"/>
                        <path d="M12 16v6"/>
                    </Fragment>
                ),
                Cloud: (
                    <Fragment>
                        <path d="M17.5 19c0-1.7-1.3-3-3-3"/>
                        <path d="M9 19c-3.3 0-6-2.7-6-6 0-3.3 2.7-6 6-6 1.5 0 2.9.5 4.1 1.4"/>
                        <path d="M19 13.5A2.5 2.5 0 0 1 16.5 16H9"/>
                    </Fragment>
                ),
                Camera: (
                    <Fragment>
                        <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/>
                        <circle cx="12" cy="13" r="3"/>
                    </Fragment>
                ),
                Coffee: (
                    <Fragment>
                        <path d="M17 8h1a4 4 0 1 1 0 8h-1"/>
                        <path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/>
                        <line x1="6" x2="6" y1="1" y2="4"/>
                        <line x1="10" x2="10" y1="1" y2="4"/>
                        <line x1="14" x2="14" y1="1" y2="4"/>
                    </Fragment>
                ),
                Utensils: (
                    <Fragment>
                        <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/>
                        <path d="M7 2v20"/>
                        <path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/>
                    </Fragment>
                ),
                BedDouble: (
                    <Fragment>
                        <path d="M2 20v-8a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v8"/>
                        <path d="M4 10V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v4"/>
                        <path d="M12 4v6"/>
                        <path d="M2 18h20"/>
                    </Fragment>
                ),
                Star: <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>,
                Compass: (
                    <Fragment>
                        <circle cx="12" cy="12" r="10"/>
                        <polygon points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"/>
                    </Fragment>
                ),
                ArrowRight: (
                    <Fragment>
                        <path d="M5 12h14"/>
                        <path d="m12 5 7 7-7 7"/>
                    </Fragment>
                )
            };

            const content = icons[name] || null;

            return (
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width={size} 
                    height={size} 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    strokeWidth="2" 
                    strokeLinecap="round" 
                    strokeLinejoin="round" 
                    className={className}
                >
                    {content}
                </svg>
            );
        };

        // --- Data & Configuration ---

        const MORANDI_COLORS = {
            bg: 'bg-[#FDFCF8]', 
            primary: 'bg-[#8F9E9D]', 
            secondary: 'bg-[#D4C4B7]', 
            accent: 'bg-[#E6DECA]', 
            text: 'text-[#4A4A4A]', 
            textLight: 'text-[#8C8C8C]',
            card: 'bg-white',
            highlight: 'text-[#C78F76]' 
        };

        const generateDates = () => {
            const dates = [];
            const start = new Date(2026, 4, 24); 
            const end = new Date(2026, 5, 12);   
            
            // City mapping for date selector
            const cityMap = {
                1: '飛機上',
                2: '札格瑞布',
                3: '札格瑞布\n盧比安納',
                4: '盧比安納',
                5: '盧比安納\n布萊德'
            };

            let current = start;
            let dayCount = 1;

            while (current <= end) {
                dates.push({
                    dateObj: new Date(current),
                    dayNum: dayCount,
                    dayString: `${current.getMonth() + 1}/${current.getDate()}`,
                    weekDay: current.toLocaleDateString('zh-TW', { weekday: 'short' }),
                    city: cityMap[dayCount] || ''
                });
                current.setDate(current.getDate() + 1);
                dayCount++;
            }
            return dates;
        };

        const tripDates = generateDates();

        // Helper for inline map button (The "Raindrop")
        const MapLink = ({ url }) => (
            <a 
                href={url}
                target="_blank"
                rel="noreferrer"
                className={`inline-flex items-center justify-center ml-2 p-1 rounded-full ${MORANDI_COLORS.bg} text-[#C78F76] hover:bg-[#FFF] border border-gray-200 transition-colors align-bottom cursor-pointer`}
                style={{ verticalAlign: 'middle' }}
                onClick={(e) => e.stopPropagation()}
            >
                <div className="w-3 h-3 flex items-center justify-center rounded-tr-[50%] rounded-tl-[50%] rounded-bl-[50%] rounded-br-0 transform rotate-45 border border-current">
                     <div className="w-0.5 h-0.5 bg-current rounded-full transform -rotate-45" />
                </div>
            </a>
        );

        const itineraryData = {
            1: [ 
                {
                    id: 'd1-1',
                    time: '18:30',
                    title: '前往機場',
                    type: 'transport',
                    iconName: 'Plane',
                    location: '桃園國際機場',
                    desc: '準備出發前往西巴爾幹半島！建議提早3小時抵達機場辦理登機手續。',
                    tips: ['檢查電源轉接頭', '下載離線地圖', '攜帶頸枕']
                },
                {
                    id: 'd1-2',
                    time: '21:00',
                    title: '飛往杜布羅夫尼克',
                    type: 'transport',
                    iconName: 'Plane',
                    subtitle: '轉機',
                    location: '伊斯坦堡機場 (轉機)',
                    desc: '長途飛行，請多補充水分。預計在伊斯坦堡轉機。',
                    tips: ['機上保濕', '調整手錶時差']
                }
            ],
            2: [ 
                {
                    id: 'd2-1',
                    time: '14:00',
                    title: '租車',
                    type: 'transport',
                    iconName: 'Car',
                    location: 'Zagreb Airport',
                    mapLink: 'https://maps.app.goo.gl/zEc8CPN39NLXcLzf6',
                    subtitle: '機場取車',
                    desc: '辦理租車手續，準備開始西巴爾幹半島的自駕之旅。請務必詳細檢查車況及保險文件。',
                    tips: ['準備國際駕照', '確認油箱返還規定', '檢查車身刮痕']
                },
                {
                    id: 'd2-2',
                    time: '15:30',
                    title: 'Olive Tree City Corner',
                    type: 'hotel',
                    iconName: 'BedDouble',
                    subtitle: 'Booking/check in',
                    location: 'Olive Tree City Corner, Zagreb',
                    mapLink: 'https://maps.app.goo.gl/T6FTVhCTjEoCbxdu6',
                    desc: '抵達今日住宿地點辦理入住手續，稍作休息。',
                    tips: ['確認停車位置', '詢問房東當地推薦']
                },
                {
                    id: 'd2-3',
                    time: '16:30',
                    title: '札格瑞布舊城漫遊',
                    type: 'sightseeing',
                    iconName: 'Camera',
                    subtitle: '主教座堂、石門、聖馬爾谷教堂',
                    location: 'Zagrebačka katedrala',
                    mapLink: 'https://maps.app.goo.gl/7EzQcsDABBNFR2JQ8',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">漫步於札格瑞布上城區，探索三大歷史地標：</p>

                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【札格瑞布主教座堂】 
                                    <MapLink url="https://maps.app.goo.gl/LUBdDPyV9ESCDgyM8" />
                                </h4>
                                <ul className="text-sm text-gray-600 space-y-1 list-none pl-0">
                                    <li>1. 克羅埃西亞最高、最具代表性的哥德式地標：擁有雙尖塔，是 Zagreb 天際線最顯眼的建築，但因 2020 地震受損，目前仍在修復（外觀部分有鷹架）。</li>
                                    <li>2. 教堂歷史超過八百年，是首都最重要宗教中心：內部以哥德式拱頂、彩繪玻璃與雕刻聞名；地震後雖可能僅部分開放，但仍值得一訪。</li>
                                    <li>3. 外觀拍照非常壯觀，周邊廣場也適合停留：廣場空間大，適合拍整體建築；若想拍上城全景，可在同一天搭 Funicular 去塔上補景。</li>
                                </ul>
                            </div>

                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【石門】
                                    <MapLink url="https://maps.app.goo.gl/eN9HqDhoKveSN28d6" />
                                </h4>
                                <ul className="text-sm text-gray-600 space-y-1 list-none pl-0">
                                    <li>1. 上城僅存的中世紀城門，城市重要歷史遺址：原本是城牆的一部分，13 世紀建成，是 Zagreb 少數保留至今的城門。</li>
                                    <li>2. 門內供奉奇蹟聖母畫像，被視為守護 Zagreb 的象徵：據說 1731 大火中所有物品燒毀，只有聖母畫像完好無損，因此成為市民重要的祈願地點。</li>
                                    <li>3. 氣氛寧靜、帶有神聖感，可短暫停留點蠟燭：遊客多是靜靜經過、拍照或祈願；參觀免費，行程可在 5–10 分鐘內完成。</li>
                                </ul>
                            </div>

                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【聖馬爾谷教堂】
                                    <MapLink url="https://maps.app.goo.gl/kh5qDiZeJnayCNBJ7" />
                                </h4>
                                <ul className="text-sm text-gray-600 space-y-1 list-none pl-0">
                                    <li>1. Zagreb 的視覺標誌，以彩色瓷磚屋頂最具代表性：屋頂圖案呈現 克羅埃西亞國徽 + Zagreb 市徽，拍照非常亮眼，是必訪地標。</li>
                                    <li>2. 位於上城最古老區域，周邊是國會與政府機構：聖馬爾谷廣場周邊開闊、典雅，是 Zagreb 政治中心與歷史重心。</li>
                                    <li>3. 建築本體為羅馬式＋哥德式混合風格：內部偶爾開放（不固定），但外觀本身就相當值得欣賞；建議白天拍一次、傍晚光線下再看一次更漂亮。</li>
                                </ul>
                            </div>
                        </Fragment>
                    ),
                    tips: ['穿著舒適好走的鞋', '石門為肅靜場所請保持安靜', '教堂內部參觀需注意開放時間']
                }
            ],
            3: [
                {
                    id: 'd3-1',
                    time: '09:00',
                    title: '早餐',
                    type: 'food',
                    iconName: 'Coffee',
                    location: 'Zagreb',
                    desc: '享受美好的早餐時光，為新的一天補充滿滿活力。',
                    tips: []
                },
                {
                    id: 'd3-combined',
                    time: '10:00',
                    title: '札格瑞布下城漫步',
                    type: 'sightseeing',
                    iconName: 'Camera',
                    subtitle: '公園、市場與廣場',
                    location: 'Zrinjevac Park, Zagreb',
                    mapLink: 'https://maps.app.goo.gl/MBA9ahmZafFHqB2Y7', // Primary link (Zrinjevac)
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">早晨在下城區（Donji Grad）愜意散步，一路從公園漫遊至熱鬧的市集：</p>

                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【Zrinjevac Park】 
                                    <MapLink url="https://maps.app.goo.gl/MBA9ahmZafFHqB2Y7" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    正式名稱為 Nikola Šubić Zrinski 廣場，是札格瑞布著名的「綠色馬蹄」公園序列的一部分。公園中心有建於1891年的音樂涼亭，四周環繞著百年懸鈴木與噴泉，氛圍優雅浪漫。
                                </p>
                            </div>

                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【托米斯拉夫國王噴泉】
                                    <MapLink url="https://maps.app.goo.gl/n4DVFc5MyALF2pJx9" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    位於火車總站正對面（King Tomislav Square）。廣場上矗立著克羅埃西亞第一位國王托米斯拉夫的騎馬雕像，紀念他在925年加冕的歷史時刻。雕像後方是黃色的藝術展覽館（Art Pavilion），展現了華麗的新藝術風格。
                                </p>
                            </div>

                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【耶拉契奇總督廣場】
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Ban+Jelačić+Square" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    札格瑞布的地理中心與主廣場，連接著上城與下城。廣場中央是19世紀總督 Josip Jelačić 的騎馬雕像，他是克羅埃西亞的民族英雄。由此上階梯約1分鐘即達市場。
                                </p>
                            </div>

                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【多拉茨市場 (Dolac Market)】
                                    <MapLink url="https://maps.app.goo.gl/fqnhjcCdCPA8VhrE8" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    札格瑞布最著名的「紅傘市場」，也是在地人的廚房。充滿鮮豔的紅色遮陽傘，適合購買新鮮水果、蜂蜜，體驗當地生活。
                                </p>
                            </div>
                        </Fragment>
                    ),
                    tips: [
                        '市集部分攤販僅收現金，建議帶小額歐元', 
                        '水果可請店家「幫你挑一盒好吃的」', 
                        '推薦邊走邊吃：葡萄、櫻桃、無花果',
                        'Dolac Market 很安全，但旅遊區仍注意包包'
                    ]
                },
                {
                    id: 'd3-funicular-tower',
                    time: '11:30',
                    title: '登山纜車 & 洛特爾薩克塔',
                    type: 'activity',
                    iconName: 'Compass',
                    subtitle: '通往上城、警盜鐘與大炮',
                    location: 'Lotrščak Tower',
                    mapLink: 'https://maps.app.goo.gl/b261uivUK7pmrhi79',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                <span className="font-bold text-gray-800">【搭乘登山纜車 (Funicular)】</span><br/>
                                連接下城區與上城區，被譽為世界上最短的公共交通纜車之一。纜車站就在市場旁東南側，下坡步行約3分鐘可到。
                            </p>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                <span className="font-bold text-gray-800">【洛特爾薩克塔 (Lotrščak Tower)】</span><br/>
                                位於纜車上站出口。建於13世紀，原為防禦工事，名為「盜賊之鐘」，古時每晚敲鐘提醒城外居民回家。
                            </p>
                            <div className="p-4 bg-gray-50 rounded-xl border border-gray-100 mb-2">
                                <h4 className="font-bold text-gray-700 mb-2 flex items-center gap-2">
                                    <Icon name="Clock" size={16} /> 12:00 正午大炮
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed mb-2">
                                    自1877年起，每天正午12點整，塔樓頂端的大炮 (Grič Cannon) 會準時鳴響，為全城校對時間。
                                </p>
                                <ul className="text-sm text-gray-600 space-y-1 list-disc pl-4">
                                    <li>建議 11:50 前抵達塔樓下方佔位。</li>
                                    <li>炮聲非常響亮，請做好心理準備。</li>
                                    <li>可購票登塔，360度俯瞰城市紅瓦屋頂。</li>
                                </ul>
                            </div>
                        </Fragment>
                    ),
                    tips: ['正午大炮聲音非常大，請注意安全', '纜車車程很短但體驗獨特']
                },
                {
                    id: 'd3-9',
                    time: '12:15',
                    title: '午餐',
                    type: 'food',
                    iconName: 'Utensils',
                    location: 'Tkalčićeva Street',
                    desc: '建議在 Tkalčićeva 街或主廣場附近用餐，這一帶聚集了許多餐廳、咖啡館與酒吧，選擇非常豐富。',
                    tips: []
                },
                {
                    id: 'd3-travel-checkin',
                    time: '14:30',
                    title: '前往盧比安納 & 入住',
                    type: 'transport',
                    iconName: 'Car',
                    subtitle: '車程1時40分 • AB Ljubljana Apartment',
                    location: 'Ljubljana, Slovenia',
                    desc: (
                        <Fragment>
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【前往盧比安納】
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    開車離開札格瑞布 (Zagreb)，前往斯洛維尼亞首都盧布爾雅那 (Ljubljana)。提早出發可以避免塞車，並剛好於下午抵達目的地。
                                </p>
                            </div>
                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【AB Ljubljana - Prince Filip Apartment】
                                    <MapLink url="https://maps.app.goo.gl/ZBAMcUDtb9iMhMMs7" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    預計 16:30 抵達住宿地點。辦理入住手續，放下行李並稍作休息，為傍晚的城市漫遊養精蓄銳。
                                </p>
                            </div>
                        </Fragment>
                    ),
                    tips: ['跨國自駕請確認過境文件', '準備斯洛維尼亞高速公路通行證 (Vignette)']
                },
                {
                    id: 'd3-12',
                    time: '17:15',
                    title: '盧比安納市中心漫遊',
                    type: 'sightseeing',
                    iconName: 'Camera',
                    subtitle: '普列舍倫廣場、三重橋',
                    location: 'Prešernov trg',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                傍晚時分，來到盧比安納最熱鬧的中心地帶，欣賞這座城市最經典的建築與河畔夜景。
                            </p>
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【普列舍倫廣場 (Prešernov trg)】 
                                    <MapLink url="https://maps.app.goo.gl/f2dcEMFHYewVjR2KA" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    盧比安納最熱鬧的中心，以斯洛維尼亞偉大詩人法蘭策·普列舍倫 (France Prešeren) 命名。廣場旁粉紅色的方濟各會教堂 (Franciscan Church) 是最顯眼的地標，也是當地人約會碰面的熱門地點。
                                </p>
                            </div>
                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【三重橋 (Triple Bridge)】 
                                    <MapLink url="https://maps.app.goo.gl/FMNMuYQ5jh11BnwB9" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    建築大師約熱·普列奇尼克 (Jože Plečnik) 的經典作品。原本只有中間的一座石橋，後來為了疏導交通，大師巧妙地在兩側各加了一座行人橋，形成了獨特的三叉造型。晚上河畔燈光倒映在盧布爾雅尼察河面，景色非常迷人，記得從橋的兩側拍攝全景。
                                </p>
                            </div>
                        </Fragment>
                    ),
                    tips: ['晚上河畔燈光倒映河面非常漂亮', '三重橋是 Plečnik 建築經典', '記得從橋的兩側拍全景']
                },
                {
                    id: 'd3-13',
                    time: '18:00',
                    title: '城市象徵巡禮',
                    type: 'sightseeing',
                    iconName: 'Camera',
                    subtitle: '龍橋、中央市場',
                    location: 'Dragon Bridge',
                    desc: (
                        <Fragment>
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【龍橋 (Dragon Bridge)】 
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Dragon+Bridge+Ljubljana" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    這座橋建於1901年，展現了維也納分離派風格。橋頭四個角落的飛龍雕像是盧比安納最著名的象徵，也是遊客必拍的打卡點。
                                </p>
                            </div>
                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【中央市場 (Central Market)】 
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Central+Market+Ljubljana" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    同樣由 Plečnik 設計的市場建築群。雖然傍晚時分攤販已收，但沿著河岸的拱廊建築（Plečnik's Arcade）非常有氣氛，適合輕鬆散步與拍照。
                                </p>
                            </div>
                        </Fragment>
                    ),
                    tips: ['龍橋的雕像是城市象徵', '傍晚市場外圍適合散步拍照']
                },
                {
                    id: 'd3-14',
                    time: '19:00',
                    title: '晚餐',
                    type: 'food',
                    iconName: 'Utensils',
                    subtitle: '自炊',
                    location: 'Ljubljana Accommodation',
                    desc: '享受自炊晚餐的樂趣。可以在超市購買當地食材，簡單烹調美味的一餐，享受像當地人一樣的生活步調。',
                    tips: ['超市可買到斯洛維尼亞當地食材', '享受放鬆的晚餐時光']
                },
                {
                    id: 'd3-15',
                    time: '20:30',
                    title: '河畔散步',
                    type: 'relax',
                    iconName: 'Coffee',
                    location: 'Ljubljanica River',
                    mapLink: 'https://maps.app.goo.gl/QPMrvxzf38D6VePX8',
                    desc: '盧比安納的治安很好，夜晚沿著盧布爾雅尼察河畔散步非常愜意且安全。河岸兩旁有許多露天酒吧與咖啡館，燈火通明，充滿悠閒的生活氣息。',
                    tips: ['夜晚安全、愜意', '感受河畔悠閒氛圍']
                }
            ],
            4: [
                {
                    id: 'd4-1',
                    time: '09:00',
                    title: '盧比安納城堡',
                    type: 'sightseeing',
                    iconName: 'Compass',
                    subtitle: 'Ljubljanski grad',
                    location: 'Ljubljana Castle',
                    mapLink: 'https://www.google.com/maps/search/?api=1&query=Ljubljana+Castle',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                矗立在市中心山丘上的盧比安納城堡，是這座城市的守護者，擁有約900年的歷史。從最初的中世紀堡壘，歷經哈布斯堡王朝的改建，曾作為防禦工事、軍火庫，甚至監獄。如今，它是盧比安納最重要的文化景點與眺望點。
                            </p>
                            
                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-2 flex items-center">
                                    必看亮點：
                                </h4>
                                <ul className="text-sm text-gray-600 space-y-2 list-none pl-0">
                                    <li>
                                        <span className="font-bold text-gray-700">【景觀塔 (Viewing Tower)】</span><br/>
                                        城堡最高點，提供 360 度絕佳視野，天氣好時可遠眺朱利安阿爾卑斯山，是拍攝城市紅瓦屋頂的最佳位置。
                                    </li>
                                    <li>
                                        <span className="font-bold text-gray-700">【木偶博物館 (Museum of Puppetry)】</span><br/>
                                        斯洛維尼亞擁有豐富的木偶戲傳統，這裡展示了各種有趣的木偶與互動裝置。
                                    </li>
                                    <li>
                                        <span className="font-bold text-gray-700">【城堡庭院】</span><br/>
                                        寬敞的哥德式庭院，氣氛悠閒，經常舉辦露天音樂會與電影放映。
                                    </li>
                                </ul>
                            </div>
                            
                            <div className="p-3 bg-gray-50 rounded-lg border border-gray-100 text-sm text-gray-600">
                                <span className="font-bold">💡 參觀建議：</span> 搭乘纜車上山最省力（來回票較划算），若時間有限，建議優先登上景觀塔並在庭院散步，感受居高臨下的氛圍。
                            </div>
                        </Fragment>
                    ),
                    tips: ['纜車來回票較划算', '景觀台視野極佳']
                },
                {
                    id: 'd4-2',
                    time: '11:00',
                    title: '老城區散步',
                    type: 'sightseeing',
                    iconName: 'Camera',
                    subtitle: 'Stari trg & Gornji trg',
                    location: 'Old Town, Ljubljana',
                    mapLink: 'https://maps.app.goo.gl/bKZvT7cViwRTryVm8',
                    desc: (
                        <Fragment>
                            <div className="mb-4 flex items-center">
                                <span className="font-bold text-gray-800">散步路線</span>
                                <MapLink url="https://maps.app.goo.gl/fss7bvUgLN7RGd369" />
                            </div>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                下山後漫步於老城區，這裡充滿可愛的小店與咖啡館，沿途更是橋樑建築的巡禮。
                            </p>
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【聖尼各老主教座堂】 
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Ljubljana+Cathedral" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    Stolnica Sv. Nikolaj，著名的雙塔地標，內部裝飾華麗，大門上的浮雕也值得細看。
                                </p>
                            </div>
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【屠夫橋 (Mesarski most)】
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Butchers'+Bridge+Ljubljana" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    雖然名為屠夫橋，橋上卻掛滿了象徵愛情的鎖，還有許多奇特的現代雕塑，形成強烈的對比。
                                </p>
                            </div>
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【龍橋 (Zmajski most)】
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Dragon+Bridge+Ljubljana" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    盧比安納最具代表性的地標。橋頭四個角落鎮守著張牙舞爪的飛龍銅像，展現了這座「龍之城」的威嚴與神話色彩。
                                </p>
                            </div>
                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【鞋匠橋 (Šuštarski most)】
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Cobblers'+Bridge+Ljubljana" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    這也是建築大師 Plečnik 的作品。橋上矗立著多根高低錯落的石柱，古時候鞋匠們常在此處擺攤交易，因而得名。現在則是街頭藝人表演的熱門場所。
                                </p>
                            </div>
                        </Fragment>
                    ),
                    tips: ['老城區巷弄很適合隨意探索']
                },
                {
                    id: 'd4-3',
                    time: '12:00',
                    title: '老城午餐',
                    type: 'food',
                    iconName: 'Utensils',
                    subtitle: '在地美食推薦',
                    location: 'Ljubljana Old Town',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                在老城區享用美味午餐，推薦兩間不同風格的餐廳：
                            </p>
                            <ul className="list-none pl-0 space-y-4">
                                <li>
                                    <div className="font-bold text-gray-800 flex items-center mb-1">
                                        Druga Violina
                                        <MapLink url="https://www.google.com/maps/search/?api=1&query=Druga+Violina+Ljubljana" />
                                    </div>
                                    <p className="text-sm text-gray-600">在地菜、平價且美味，這是一間雇用身心障礙人士的社會企業餐廳，氣氛溫馨。</p>
                                </li>
                                <li>
                                    <div className="font-bold text-gray-800 flex items-center mb-1">
                                        Valvas’or
                                        <MapLink url="https://www.google.com/maps/search/?api=1&query=Valvasor+Ljubljana" />
                                    </div>
                                    <p className="text-sm text-gray-600">如果想要比較精緻的用餐體驗，這裡提供高品質的現代歐式料理。</p>
                                </li>
                            </ul>
                        </Fragment>
                    ),
                    tips: ['熱門餐廳建議先訂位']
                },
                {
                    id: 'd4-4',
                    time: '13:45',
                    title: '藝術博物館巡禮',
                    type: 'activity',
                    iconName: 'Camera',
                    subtitle: '依喜好二選一',
                    location: 'National Gallery of Slovenia',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                依您的喜好選擇一個參觀：
                            </p>
                            <ul className="list-none pl-0 space-y-4">
                                <li>
                                    <div className="font-bold text-gray-800 flex items-center mb-1">
                                        喜歡畫作 → 國家美術館
                                        <MapLink url="https://www.google.com/maps/search/?api=1&query=National+Gallery+of+Slovenia" />
                                    </div>
                                    <p className="text-sm text-gray-600">National Gallery，收藏豐富的斯洛維尼亞與歐洲藝術畫作。</p>
                                </li>
                                <li>
                                    <div className="font-bold text-gray-800 flex items-center mb-1">
                                        喜歡現代藝術 → 現代博物館
                                        <MapLink url="https://www.google.com/maps/search/?api=1&query=Moderna+galerija+Ljubljana" />
                                    </div>
                                    <p className="text-sm text-gray-600">Moderna Galerija，展示20世紀以來的現代藝術作品。</p>
                                </li>
                            </ul>
                        </Fragment>
                    ),
                    tips: []
                },
                {
                    id: 'd4-5',
                    time: '15:15',
                    title: '蒂沃利公園',
                    type: 'relax',
                    iconName: 'Coffee',
                    subtitle: 'Tivoli Park',
                    location: 'Tivoli Park',
                    mapLink: 'https://www.google.com/maps/search/?api=1&query=Tivoli+Park+Ljubljana',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                盧比安納最漂亮的大公園。推薦走 "Jacopič Promenade" 林蔭大道，欣賞戶外攝影展，感覺非常舒服。
                            </p>
                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【Café Čolnarna Tivoli】 
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Colnarna+Tivoli" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    位於池塘邊的可愛咖啡館，很適合在這裡喝杯飲料休息，享受愜意的午後時光。
                                </p>
                            </div>
                        </Fragment>
                    ),
                    tips: []
                },
                {
                    id: 'd4-6',
                    time: '17:00',
                    title: '市中心自由活動',
                    type: 'shopping',
                    iconName: 'Info',
                    subtitle: '河畔市集或休息',
                    location: 'Ljubljana City Centre',
                    desc: '可以逛逛河畔的手作市集（若有擺攤），或是先回飯店稍作休息，為晚上的行程充電。',
                    tips: []
                },
                {
                    id: 'd4-7',
                    time: '18:00',
                    title: '晚餐＋酒吧',
                    type: 'food',
                    iconName: 'Utensils',
                    subtitle: 'Manna / Strelec / Bar',
                    location: 'Ljubljana',
                    desc: (
                        <Fragment>
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-2">推薦晚餐：</h4>
                                <ul className="list-none pl-0 space-y-3">
                                    <li>
                                        <div className="font-bold text-sm flex items-center">
                                            Manna
                                            <MapLink url="https://www.google.com/maps/search/?api=1&query=Manna+Ljubljana" />
                                        </div>
                                        <p className="text-xs text-gray-600">高級但不貴，品質超好。</p>
                                    </li>
                                    <li>
                                        <div className="font-bold text-sm flex items-center">
                                            Strelec
                                            <MapLink url="https://www.google.com/maps/search/?api=1&query=Restavracija+Strelec" />
                                        </div>
                                        <p className="text-xs text-gray-600">城堡餐廳，若想提升儀式感可選此處。</p>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <h4 className="font-bold text-gray-800 mb-2">飯後小酌：</h4>
                                <ul className="list-none pl-0 space-y-3">
                                    <li>
                                        <div className="font-bold text-sm flex items-center">
                                            Kolibri Cocktail Bar
                                            <MapLink url="https://www.google.com/maps/search/?api=1&query=Kolibri+Cocktail+Bar" />
                                        </div>
                                        <p className="text-xs text-gray-600">最推薦的雞尾酒吧。</p>
                                    </li>
                                    <li>
                                        <div className="font-bold text-sm flex items-center">
                                            TOZD
                                            <MapLink url="https://www.google.com/maps/search/?api=1&query=TOZD+bar+Ljubljana" />
                                        </div>
                                        <p className="text-xs text-gray-600">充滿文青風格的酒吧。</p>
                                    </li>
                                </ul>
                            </div>
                        </Fragment>
                    ),
                    tips: ['酒吧營業時間通常較晚，適合放鬆']
                }
            ],
            5: [
                {
                    id: 'd5-1',
                    time: '09:00',
                    title: '早安盧比安納：市場與咖啡',
                    type: 'food',
                    iconName: 'Coffee',
                    subtitle: '中央市場 • 河岸早餐',
                    location: 'Central Market, Ljubljana',
                    mapLink: 'https://www.google.com/maps/search/?api=1&query=Central+Market+Ljubljana',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                將盧比安納最道地的兩種早晨體驗結合，享受愜意的慢活時光。
                            </p>
                            
                            <div className="mb-6">
                                <h4 className="font-bold text-gray-800 mb-1 flex items-center">
                                    【中央市場早市散步】 
                                    <MapLink url="https://www.google.com/maps/search/?api=1&query=Central+Market+Ljubljana" />
                                </h4>
                                <p className="text-sm text-gray-600 leading-relaxed">
                                    早晨是市場最熱鬧的時候，充滿生活感。建議可以逛逛戶外攤位，買些新鮮水果、蜂蜜或當地火腿，邊逛邊吃小東西，感受在地人的活力。
                                </p>
                            </div>

                            <div className="mb-4">
                                <h4 className="font-bold text-gray-800 mb-2">【河岸咖啡早餐推薦】</h4>
                                <ul className="list-none pl-0 space-y-4">
                                    <li>
                                        <div className="font-bold text-sm text-gray-800 flex items-center mb-1">
                                            Café Čokl
                                            <MapLink url="https://www.google.com/maps/search/?api=1&query=Cafe+Cokl+Ljubljana" />
                                        </div>
                                        <p className="text-sm text-gray-600">如果你是咖啡愛好者，這裡有非常棒的手沖與義式咖啡。</p>
                                    </li>
                                    <li>
                                        <div className="font-bold text-sm text-gray-800 flex items-center mb-1">
                                            Le Petit Café
                                            <MapLink url="https://www.google.com/maps/search/?api=1&query=Le+Petit+Cafe+Ljubljana" />
                                        </div>
                                        <p className="text-sm text-gray-600">提供經典的法式早餐與早午餐，氣氛優雅。</p>
                                    </li>
                                </ul>
                            </div>
                        </Fragment>
                    ),
                    tips: ['市場建議早點去食材較新鮮', '熱門咖啡館可能需要稍作等待']
                },
                {
                    id: 'd5-2',
                    time: '11:30',
                    title: '前往布萊德',
                    type: 'transport',
                    iconName: 'Car',
                    subtitle: '車程約 40-50 分鐘',
                    location: 'Bled, Slovenia',
                    mapLink: 'https://www.google.com/maps/search/?api=1&query=Lake+Bled',
                    desc: (
                        <Fragment>
                            <p className="mb-4 text-gray-600 leading-relaxed text-justify">
                                告別可愛的盧比安納，開車前往斯洛維尼亞最夢幻的景點——布萊德湖 (Lake Bled)。
                            </p>
                            <div className="p-3 bg-gray-50 rounded-lg border border-gray-100 text-sm text-gray-600">
                                <span className="font-bold">🚗 駕駛提醒：</span> 沿著 A2 高速公路行駛，路況通常良好。接近布萊德時可能會有些許車潮，請放慢速度欣賞沿途阿爾卑斯山腳下的美景。
                            </div>
                        </Fragment>
                    ),
                    tips: ['確認行李都已上車', '準備好相機迎接湖光山色']
                }
            ],
            20: [ 
                {
                    id: 'd20-1',
                    time: '06:00',
                    title: '抵達台灣',
                    type: 'arrival',
                    iconName: 'MapPin',
                    note: '平安回家',
                    location: '桃園國際機場',
                    desc: '旅程結束，帶著滿滿的回憶回到溫暖的家。',
                    tips: ['整理照片', '補眠調整時差']
                }
            ]
        };

        const getDayEvents = (dayNum) => {
            if (itineraryData[dayNum]) return itineraryData[dayNum];
            
            return [
                {
                    id: `gen-${dayNum}-1`,
                    time: '09:30',
                    title: '城市探索',
                    type: 'sightseeing',
                    iconName: 'Camera',
                    location: 'City Center',
                    desc: '享受當地的早晨氛圍，探索巷弄間的驚喜。',
                    tips: ['尋找當地咖啡館', '購買紀念品']
                },
                {
                    id: `gen-${dayNum}-2`,
                    time: '13:00',
                    title: '當地美食饗宴',
                    type: 'food',
                    iconName: 'Utensils',
                    location: 'Local Restaurant',
                    desc: '品嚐西巴爾幹半島的特色料理，如烤肉卷 (Ćevapi) 或布雷克餅 (Burek)。',
                    tips: ['嘗試當地啤酒或葡萄酒']
                },
                {
                    id: `gen-${dayNum}-3`,
                    time: '16:00',
                    title: '午後休憩',
                    type: 'relax',
                    iconName: 'Coffee',
                    location: 'Old Town Cafe',
                    desc: '在露天咖啡座休息，觀察路人，享受悠閒的歐洲步調。',
                    tips: []
                }
            ];
        };

        // --- Main Components ---

        const DetailView = ({ item, onClose }) => {
            if (!item) return null;

            return (
                <div className="fixed inset-0 z-50 flex items-end sm:items-center justify-center pointer-events-none">
                    {/* Backdrop */}
                    <div 
                        className="absolute inset-0 bg-black/40 backdrop-blur-sm pointer-events-auto transition-opacity duration-300"
                        onClick={onClose}
                    />
                    
                    {/* Card Content */}
                    <div className="relative w-full max-w-md h-[85vh] sm:h-[600px] bg-[#FDFCF8] rounded-t-3xl sm:rounded-3xl shadow-2xl overflow-hidden pointer-events-auto flex flex-col transform transition-transform duration-300 ease-out translate-y-0 animate-fade-in">
                        
                        {/* Header Bar */}
                        <div className="flex items-center justify-between p-4 border-b border-gray-100 bg-white/80 backdrop-blur-md sticky top-0 z-10">
                            <button 
                                onClick={onClose}
                                className="p-2 -ml-2 rounded-full hover:bg-gray-100 transition-colors text-gray-600"
                            >
                                <Icon name="ChevronLeft" size={24} />
                            </button>
                            
                            <h2 className={`text-lg font-serif font-bold ${MORANDI_COLORS.text} truncate flex-1 text-center px-2`}>
                                {item.title}
                            </h2>

                             <div className="w-8"></div>
                        </div>

                        {/* Content */}
                        <div className="flex-1 overflow-y-auto p-6 pt-6">
                            
                            <div className="flex flex-col items-center gap-4 mb-6">
                                {/* Time Badge */}
                                <div className="flex items-center gap-2">
                                     <span className={`px-3 py-1 rounded-full text-xs font-medium ${MORANDI_COLORS.primary} text-white`}>
                                        {item.time}
                                    </span>
                                     <span className="text-xs text-gray-400 uppercase tracking-wider bg-gray-100 px-2 py-1 rounded-md">{item.type}</span>
                                </div>
                            </div>

                            <div className="prose prose-sm mb-8">
                                <h3 className={`text-lg font-medium mb-3 ${MORANDI_COLORS.highlight}`}>關於此行程</h3>
                                <div className="text-gray-600 leading-relaxed text-justify">
                                    {item.desc}
                                </div>
                            </div>

                            {item.tips && item.tips.length > 0 && (
                                <div className={`p-5 rounded-2xl ${MORANDI_COLORS.accent} bg-opacity-30 mb-8`}>
                                    <h3 className={`text-sm font-bold mb-3 flex items-center gap-2 ${MORANDI_COLORS.text}`}>
                                        <Icon name="Star" size={16} /> 貼心小提醒
                                    </h3>
                                    <ul className="space-y-2">
                                        {item.tips.map((tip, idx) => (
                                            <li key={idx} className="flex items-start gap-2 text-sm text-gray-700">
                                                <span className="mt-1.5 w-1.5 h-1.5 rounded-full bg-gray-400 flex-shrink-0" />
                                                {tip}
                                            </li>
                                        ))}
                                    </ul>
                                </div>
                            )}
                            
                            {/* Bottom Button Removed */}
                        </div>
                    </div>
                </div>
            );
        };

        const InfoPage = () => {
            return (
                <div className="p-6 pb-24 space-y-6 animate-fade-in">
                    <h2 className={`text-2xl font-serif font-bold ${MORANDI_COLORS.text}`}>旅遊資訊</h2>
                    
                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div className="flex items-center gap-3 mb-4">
                            <div className="text-gray-400"><Icon name="Plane" size={24}/></div>
                            <h3 className="font-bold text-lg text-gray-700">航班資訊</h3>
                        </div>
                        <div className="space-y-4">
                            <div className="border-l-2 border-gray-200 pl-4">
                                <p className="text-xs text-gray-400">去程 5/24</p>
                                <p className="font-medium text-gray-800">TK025 TPE - IST</p>
                                <p className="text-sm text-gray-500">21:55 - 05:10 (+1)</p>
                            </div>
                            <div className="border-l-2 border-gray-200 pl-4">
                                <p className="text-xs text-gray-400">轉機 5/25</p>
                                <p className="font-medium text-gray-800">TK439 IST - DBV</p>
                                <p className="text-sm text-gray-500">07:30 - 08:20</p>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
                        <div className="flex items-center gap-3 mb-4">
                             <div className="text-gray-400"><Icon name="Info" size={24}/></div>
                            <h3 className="font-bold text-lg text-gray-700">行前清單</h3>
                        </div>
                        <ul className="space-y-3">
                            {['護照 (效期6個月以上)', '歐元現金', '海外旅遊保險證明', '轉接頭 (歐規雙圓孔)', '常用藥品'].map((item, i) => (
                                <li key={i} className="flex items-center gap-3 text-sm text-gray-600">
                                    <div className={`w-4 h-4 rounded border ${MORANDI_COLORS.primary} flex items-center justify-center`}>
                                        <div className={`w-2 h-2 rounded-sm ${MORANDI_COLORS.primary}`} />
                                    </div>
                                    {item}
                                </li>
                            ))}
                        </ul>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('itinerary'); 
            const [selectedDateIdx, setSelectedDateIdx] = useState(0);
            const [viewingItem, setViewingItem] = useState(null);
            const scrollRef = useRef(null);

            const currentDate = tripDates[selectedDateIdx];
            const currentEvents = getDayEvents(currentDate.dayNum);
            
            useEffect(() => {
                if (scrollRef.current) {
                    const activeEl = scrollRef.current.children[selectedDateIdx];
                    if (activeEl) {
                        activeEl.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                    }
                }
            }, [selectedDateIdx]);

            return (
                <div className={`min-h-screen ${MORANDI_COLORS.bg} font-sans selection:bg-[#D4C4B7] selection:text-white`}>
                    <div className="max-w-md mx-auto bg-[#FDFCF8] min-h-screen relative shadow-2xl overflow-hidden flex flex-col">
                        
                        {/* Header */}
                        <div className="pt-8 px-6 pb-4 bg-white/50 backdrop-blur-sm sticky top-0 z-10">
                            <h1 className={`text-2xl font-serif font-bold ${MORANDI_COLORS.text} tracking-wide`}>
                                西巴爾幹之旅
                            </h1>
                            <p className="text-xs text-gray-500 mt-1 tracking-widest uppercase">
                                2026 MAY 24 - JUN 12
                            </p>
                        </div>

                        {activeTab === 'itinerary' ? (
                            <React.Fragment>
                                {/* Date Selector */}
                                <div className="border-b border-gray-200 bg-white shadow-sm z-0">
                                    <div 
                                        ref={scrollRef}
                                        className="flex overflow-x-auto px-0 hide-scrollbar snap-x overflow-y-hidden"
                                    >
                                        {tripDates.map((d, idx) => {
                                            const isActive = idx === selectedDateIdx;
                                            return (
                                                <button
                                                    key={idx}
                                                    onClick={() => setSelectedDateIdx(idx)}
                                                    className={`snap-center flex-shrink-0 flex flex-col items-center justify-start w-16 h-20 transition-colors duration-200 border-r border-gray-50 last:border-0 pt-1 ${
                                                        isActive 
                                                            ? `${MORANDI_COLORS.primary} text-white` 
                                                            : 'bg-white text-gray-400 hover:bg-gray-50'
                                                    }`}
                                                >
                                                    <span className="text-[10px] font-medium opacity-80 uppercase tracking-wider leading-none mb-0.5">{d.weekDay}</span>
                                                    <span className="text-lg font-bold leading-none mb-0.5">{d.dateObj.getDate()}</span>
                                                    <span className="text-[9px] opacity-60 leading-none mb-0.5">D{d.dayNum}</span>
                                                    <div className="h-7 w-full flex items-center justify-center px-0.5 mt-0.5">
                                                        <span className="text-[9px] font-medium leading-[1.1] text-center whitespace-pre-line line-clamp-2">
                                                            {d.city}
                                                        </span>
                                                    </div>
                                                </button>
                                            );
                                        })}
                                    </div>
                                </div>

                                {/* Scrollable Content */}
                                <div className="flex-1 overflow-y-auto pb-24">
                                    
                                    {/* Weather Display Removed */}

                                    {/* Itinerary List */}
                                    <div className="px-6 space-y-2 mt-4">
                                        {currentEvents.map((item, idx) => (
                                            <div 
                                                key={item.id}
                                                onClick={() => setViewingItem(item)}
                                                className="group bg-white rounded-xl p-5 shadow-[0_2px_8px_-2px_rgba(0,0,0,0.05)] border border-gray-50 hover:shadow-lg transition-all duration-300 cursor-pointer relative overflow-hidden"
                                            >
                                                <div className="flex items-start gap-4">
                                                    {/* Time Column */}
                                                    <div className={`flex-shrink-0 w-14 pt-1 text-right text-sm font-bold font-serif ${MORANDI_COLORS.highlight}`}>
                                                        {item.time}
                                                    </div>

                                                    {/* Content Column */}
                                                    <div className="flex-1 min-w-0">
                                                        <div className="flex justify-between items-start mb-0.5">
                                                            <h3 className={`text-lg font-bold ${MORANDI_COLORS.text} leading-tight`}>
                                                                {item.title}
                                                            </h3>
                                                            
                                                            {/* Map Button on Card */}
                                                            <button 
                                                                onClick={(e) => {
                                                                    e.stopPropagation();
                                                                    const url = item.mapLink || `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.location)}`;
                                                                    window.open(url, '_blank');
                                                                }}
                                                                className={`ml-2 p-1.5 rounded-full ${MORANDI_COLORS.bg} text-gray-400 hover:text-[#C78F76] hover:bg-[#FFF] transition-colors flex-shrink-0`}
                                                            >
                                                                <div className="w-4 h-4 flex items-center justify-center rounded-tr-[50%] rounded-tl-[50%] rounded-bl-[50%] rounded-br-0 transform rotate-45 border-2 border-current">
                                                                    <div className="w-1 h-1 bg-current rounded-full transform -rotate-45" />
                                                                </div>
                                                            </button>
                                                        </div>
                                                        
                                                        {/* Subtitle / Location */}
                                                        <p className="text-sm text-gray-500 line-clamp-2">
                                                            {item.subtitle || item.location}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}

                                        <div className="h-10 text-center text-xs text-gray-300 pt-4">
                                            End of Day {currentDate.dayNum}
                                        </div>
                                    </div>
                                </div>
                            </React.Fragment>
                        ) : (
                            <InfoPage />
                        )}

                        {/* Bottom Navigation */}
                        <div className="absolute bottom-6 left-6 right-6">
                            <div className="bg-white/90 backdrop-blur-md rounded-full shadow-[0_8px_30px_rgb(0,0,0,0.08)] p-1.5 flex justify-between border border-white/50">
                                <button
                                    onClick={() => setActiveTab('itinerary')}
                                    className={`flex-1 py-3 rounded-full flex items-center justify-center gap-2 text-sm font-medium transition-all duration-300 ${
                                        activeTab === 'itinerary' 
                                            ? `${MORANDI_COLORS.primary} text-white shadow-md` 
                                            : 'text-gray-400 hover:bg-gray-50'
                                    }`}
                                >
                                    <Icon name="Calendar" size={18} />
                                    每日行程
                                </button>
                                <button
                                    onClick={() => setActiveTab('info')}
                                    className={`flex-1 py-3 rounded-full flex items-center justify-center gap-2 text-sm font-medium transition-all duration-300 ${
                                        activeTab === 'info' 
                                            ? `${MORANDI_COLORS.primary} text-white shadow-md` 
                                            : 'text-gray-400 hover:bg-gray-50'
                                    }`}
                                >
                                    <Icon name="Info" size={18} />
                                    旅遊資訊
                                </button>
                            </div>
                        </div>

                        {/* Details Overlay */}
                        <DetailView item={viewingItem} onClose={() => setViewingItem(null)} />

                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>


